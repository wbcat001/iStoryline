webpackJsonp([1],{"+ICT":function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("Zzkc"),a=(n.n(r),n("hxIt")),u=n("H6qF");e.a={name:"WorkSpace",data:function(){return{paintingEl:null,isShowContextMenu:!1,contextMenuPositionX:0,contextMenuPositionY:0,paintingScrollX:0,paintingScrollY:0,mouse:{positionX:0,positionY:0,upCount:0,downCount:0}}},computed:s()({},Object(i.c)(["isUsingFillColor","isUsingStrokeColor","paintingCardList","objectStyle","objects"])),mounted:function(){this.$store.dispatch("addPaintingCard"),this.paintingEl=document.getElementById("painting")},methods:s()({handleMousemove:function(){this.mouse.positionX=event.clientX,this.mouse.positionY=event.clientY},handleMousedown:function(){0===event.button&&this.mouse.downCount++},handleMouseup:function(){0===event.button&&this.mouse.upCount++},handleContextmenu:function(){this.contextMenuPositionX=this.mouse.positionX,this.contextMenuPositionY=this.mouse.positionY,this.isShowContextMenu=!0},handleClick:function(){this.isShowContextMenu=!1},handleScroll:function(){this.paintingScrollX=this.paintingEl.scrollLeft,this.paintingScrollY=this.paintingEl.scrollTop}},Object(i.b)(["addPaintingCard"])),components:{"context-menu":a.a,"color-picker":r.Sketch,"svg-card":u.a}}},"/scB":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"line"},[n("path",{attrs:{d:t.pathD,fill:t.fillColor,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),t._l(t.nodes,function(e,o){return n("controlnode",{directives:[{name:"show",rawName:"v-show",value:t.reshape,expression:"reshape"}],key:o,attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,node:e}})})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},"/vB+":function(t,e,n){"use strict";function o(t){n("4yjx")}var s=n("ecCa"),i=n("nNI8"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},"01qU":function(t,e){},"0bPP":function(t,e){},"0d6M":function(t,e,n){"use strict";var o=n("17Zw"),s=n("nbaU"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},"0sPE":function(t,e,n){"use strict";e.a={name:"TreeNode",props:{model:Object},data:function(){return{open:!1}},computed:{isFolder:function(){return this.model.children&&this.model.children.length},visible:function(){return this.model.isShow}},methods:{toggle:function(){this.isFolder&&(this.open=!this.open)},changeVisible:function(){this.model.isShow?this.model.closeShow():this.model.activateShow()},changeType:function(){this.isFolder||(this.$set(this.model,"children",[]),this.addChild(),this.open=!0)},addChild:function(){this.model.children.push({name:"new element"})}}}},"17Zw":function(t,e,n){"use strict";var o=n("1N/p");e.a={name:"Triangle",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],mounted:function(){this.object.isCreate||(this.object.addBezierNode(150,50,150,50),this.object.addBezierNode(50,150,50,150),this.object.addBezierNode(250,150,250,150),this.object.init())},computed:{nodes:function(){return this.object.nodes},visible:function(){return this.object.isShow},reshape:function(){return this.object.isReshape},pathD:function(){var t="";return this.nodes.forEach(function(e,n){t+=0===n?"M "+e.x+" "+e.y:" L "+e.x+" "+e.y}),this.nodes.length>2&&(t+=" L "+this.nodes[0].x+" "+this.nodes[0].y),t}},components:{controlnode:o.a}}},"1N/p":function(t,e,n){"use strict";var o=n("ayw7"),s=n("Skty"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},"24zk":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"side-panel-bar"},[n("div",{staticClass:"side-panel-item",on:{click:t.handleElementPanel}},[n("icon",{attrs:{name:"navicon",scale:"2"}}),t._v(" "),n("span",[t._v("Element")])],1),t._v(" "),n("div",{staticClass:"side-panel-item",on:{click:t.handleShapePanel}},[n("icon",{attrs:{name:"map",scale:"2"}}),t._v(" "),n("span",[t._v("Shape")])],1),t._v(" "),n("div",{staticClass:"side-panel-item",on:{click:t.handleTextPanel}},[n("icon",{attrs:{name:"text-width",scale:"2"}}),t._v(" "),n("span",[t._v("Text")])],1),t._v(" "),n("div",{staticClass:"side-panel-item",on:{click:t.handleStoryPanel}},[n("icon",{attrs:{name:"file-text",scale:"2"}}),t._v(" "),n("span",[t._v("Story")])],1)])},s=[],i={render:o,staticRenderFns:s};e.a=i},"2Kl6":function(t,e,n){"use strict";var o=n("lr0z"),s=n.n(o);e.a={name:"ScaleTool",computed:{icon:function(){return s.a}}}},"2htf":function(t,e){},"3LUW":function(t,e,n){"use strict";var o=n("vjNh");e.a={name:"TextObject",props:{mouse:Object,object:Object,scrollX:Number,scrollY:Number},data:function(){return{isLocated:!1,isDragged:!1,recordMouseX:0,recordMouseY:0}},methods:{handleClick:function(){this.isLocated=!this.isLocated,this.isLocated?this.$store.commit(o.p,this.object):this.$store.commit(o.z)},handleMousedown:function(){0===event.button&&(this.isDragged=!0,this.object.beginMove(),this.recordMouseX=this.mouseX,this.recordMouseY=this.mouseY)},handleMouseup:function(){0===event.button&&(this.isDragged=!1)},handleContextMenu:function(){this.$store.commit(o.n,this.object)}},computed:{visible:function(){return this.object.isShow},mouseX:function(){return this.mouse.positionX+this.scrollX},mouseY:function(){return this.mouse.positionY+this.scrollY},x:function(){return this.object.frameX},y:function(){return this.object.frameY},w:function(){return this.object.frameW},h:function(){return this.object.frameH},fontSize:function(){return this.object.fontSize},fontFamily:function(){return this.object.fontFamily},color:function(){return this.object.color},content:function(){return this.object.content},styleObject:function(){return{top:this.y+"px",left:this.x+"px",fontSize:this.fontSize+"px",fontFamily:""+this.fontFamily,color:""+this.color,cursor:"move"}}},watch:{mouseX:function(t){if(this.isDragged){var e=t-this.recordMouseX;this.object.updateX(e)}},mouseY:function(t){if(this.isDragged){var e=t-this.recordMouseY;this.object.updateY(e)}}}}},"3eZz":function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("knr3");n.n(r);e.a={name:"ScaleSelect",props:{mouseX:Number,mouseY:Number,mousedownCount:Number},data:function(){return{sPoints:[],ePoints:[],linesNum:0,mousedownNum:0}},computed:s()({},Object(i.c)(["isUsingScaleTool"])),methods:{reset:function(){this.sPoints=[],this.ePoints=[],this.linesNum=0,this.mousedownNum=0}},mounted:function(){var t=this;(new r).bind("esc",function(){2===t.linesNum&&t.isUsingScaleTool&&t.$store.dispatch("scaleSession",{sPoints:t.sPoints,ePoints:t.ePoints,linesNum:t.linesNum}),t.reset()})},watch:{mousedownCount:function(t){this.isUsingScaleTool&&(this.mousedownNum++,this.mousedownNum%2==1&&this.sPoints.push({x:this.mouseX,y:this.mouseY}),this.mousedownNum%2==0&&(this.linesNum++,this.ePoints.push({x:this.mouseX,y:this.mouseY})))},isUsingScaleTool:function(t){t?this.reset():2===this.linesNum&&this.$store.dispatch("scaleSession",{sPoints:this.sPoints,ePoints:this.ePoints,linesNum:this.linesNum})}}}},"3jbm":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"echelon"},[n("path",{attrs:{d:t.pathD,fill:t.fillColor,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),t._l(t.nodes,function(e,o){return n("controlnode",{directives:[{name:"show",rawName:"v-show",value:t.reshape,expression:"reshape"}],key:o,attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,node:e}})})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},"3zLJ":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{directives:[{name:"model",rawName:"v-model",value:t.modelVal,expression:"modelVal"}],style:t.styleObject,attrs:{type:"range",min:t.min,max:t.max,step:t.step},domProps:{value:t.modelVal},on:{__r:function(e){t.modelVal=e.target.value}}})},s=[],i={render:o,staticRenderFns:s};e.a=i},"4IQm":function(t,e,n){"use strict";var o=n("KuhB"),s=n("u4D7"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},"4yjx":function(t,e){},"58s9":function(t,e,n){"use strict";function o(t){n("segE")}var s=n("DeHT"),i=n("eVrT"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},"5G65":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{staticClass:"BezierTool"},[n("line",{attrs:{stroke:"black",x1:t.node.x3,y1:t.node.y3,x2:t.node.x2,y2:t.node.y2,"stroke-width":"1"}}),t._v(" "),n("circle",{attrs:{r:"3",cx:t.node.x3,cy:t.node.y3,fill:"black"},on:{mousedown:t.handleMousedownForSymmetryBezierNode}}),t._v(" "),n("circle",{attrs:{r:"3",cx:t.node.x2,cy:t.node.y2,fill:"black"},on:{mousedown:t.handleMousedownForBezierNode}})])},s=[],i={render:o,staticRenderFns:s};e.a=i},"5H7z":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Curving",expression:"'Curving'"}]},[n("font-awesome-icon",{attrs:{icon:t.icon}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},"5e6B":function(t,e,n){"use strict";var o=n("J+hv"),s=n.n(o);e.a={name:"OrderTool",computed:{icon:function(){return s.a}}}},"6eR/":function(t,e){},"6zYt":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;return(t._self._c||e)("icon",{attrs:{name:"pencil",scale:"1.5"}})},s=[],i={render:o,staticRenderFns:s};e.a=i},"76OO":function(t,e,n){"use strict";n.d(e,"a",function(){return f});var o=n("d7EF"),s=n.n(o),i=n("ifoU"),r=n.n(i),a=n("Zrlr"),u=n.n(a),c=n("wxAW"),l=n.n(c),h=n("z4iF"),d=n("O6Ek"),f=function(){function t(e,n,o,s,i){u()(this,t),this.data=e,this.sessionTable=n,this.frameSteps=o,this.curveSteps=s,this.positionXTable=new r.a,this.storyConfig=i,this.generatePositionXTable()}return l()(t,[{key:"generateStorylines",value:function(){for(var t=this.data,e=[],n=0,o=t.length;n<o;n++){var s=t[n],i=s.points,r=this.generateSingleStorylinePair(i,n);e.push({name:s.name,characterId:s.character_id,points:r})}return new d.a(e,this.sessionTable,this.storyConfig).twist(1),e}},{key:"generateSingleStorylinePair",value:function(t,e){for(var n=[],o=this.storyConfig.paddingLeft,s=this.storyConfig.paddingTop,i=this.storyConfig.xScaleFactor,r=this.storyConfig.yScaleFactor,a=0,u=t.length;a<u;a++){var c=t[a],l=this.getPositionX(a,!0)*i+o,d=this.getPositionX(a,!1)*i+o,f=c.item3>0?c.item3*r+s:-1e4,m=this.isStepPoint(a,e)?-5e3:f,p=new h.b(l,m),v=new h.b(d,f);n.push(p),n.push(v)}return n}},{key:"isStepPoint",value:function(t,e){var n=this.data[e].points,o=n.length;if(0===t||t===o-1)return!1;for(var s=this.sessionTable[e][t],i=0,r=0,a=this.sessionTable.length;r<a;r++){this.sessionTable[r][t]===s&&i++}if(i>2)return!1;var u=n[t-1].item3,c=n[t+1].item3,l=n[t].item3;return(l-u)*(l-c)<0}},{key:"getSegmentY",value:function(t,e){return this.data[e].points[t].item3}},{key:"getPositionX",value:function(t,e){var n=this.positionXTable.get(t),o=s()(n,2),i=o[0],r=o[1];return e?i:r}},{key:"generatePositionXTable",value:function(){for(var t=this.sessionTable[0].length,e=0,n=this.frameSteps[0],o=this.positionXTable,s=0;s<t;s++)o.set(s,[e,n]),e+=this.frameSteps[s]+this.curveSteps[s],s<t-1&&(n=e+this.frameSteps[s+1])}}]),t}()},"7TG9":function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("ikkP");e.a={name:"VisualObject",props:{mouseX:Number,mouseY:Number,mousedownCount:Number,mouseupCount:Number,object:Object},computed:s()({cursorStyle:function(){var t="move";return"storyline"===this.object.type?t="pointer":this.object.isScale&&(t="default"),this.isUsingCurveTool&&(t="crosshair"),this.isUsingBendTool&&(t="crosshair"),this.isUsingScaleTool&&(t="crosshair"),{cursor:t}}},Object(i.c)(["isUsingCurveTool","isUsingBendTool","isUsingScaleTool"])),components:{"move-frame":r.a}}},"7Tca":function(t,e,n){"use strict";var o=n("2Kl6"),s=n("W1Js"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},"9Dxg":function(t,e,n){"use strict";var o=n("yezX"),s=n("crmn"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},"9iOO":function(t,e,n){"use strict";var o=n("vjNh");e.a={name:"SidePanelBar",data:function(){return{usingElementPanel:!1,usingShapePanel:!1,usingTextPanel:!1,usingStoryPanel:!1}},methods:{handleElementPanel:function(){this.usingElementPanel=!this.usingElementPanel,this.switchPanel("ElementPanel",this.usingElementPanel)},handleShapePanel:function(){this.usingShapePanel=!this.usingShapePanel,this.switchPanel("ShapePanel",this.usingShapePanel)},handleTextPanel:function(){this.usingTextPanel=!this.usingTextPanel,this.switchPanel("TextPanel",this.usingTextPanel)},handleStoryPanel:function(){this.usingStoryPanel=!this.usingStoryPanel,this.switchPanel("StoryPanel",this.usingStoryPanel)},switchPanel:function(t,e){if(this.resetPanel(),e){switch(t){case"ElementPanel":this.usingElementPanel=!0;break;case"ShapePanel":this.usingShapePanel=!0;break;case"TextPanel":this.usingTextPanel=!0,this.$store.commit(o.t);break;case"StoryPanel":this.usingStoryPanel=!0}this.$store.commit(o.r,t)}else this.$store.commit(o.i,t)},resetPanel:function(){this.usingElementPanel=!1,this.usingShapePanel=!1,this.$store.commit(o.h),this.$store.commit(o.j),this.$store.commit(o.l,"PenTool"),this.usingTextPanel=!1,this.$store.commit(o.k),this.usingStoryPanel=!1}}}},AeaF:function(t,e,n){"use strict";var o=n("vjNh"),s=n("YfC9"),i=n("uBqI"),r=n("7Tca"),a=n("hnEm"),u=n("t2k0"),c=n("CKGA");e.a={name:"ToolItem",props:{usingToolName:String,toolName:String},data:function(){return{usingToolCard:!1,activeColor:"#ddd",styleObject:{background:""}}},watch:{usingToolName:function(t){t===this.toolName?(this.styleObject.background=this.activeColor,this.$store.commit(o.u,this.toolName),this.usingToolCard=!0):(this.styleObject.background="",this.$store.commit(o.l,this.toolName),this.$store.commit(o.g),this.usingToolCard=!1)}},methods:{handleClick:function(){this.usingToolName===this.toolName?(this.$emit("cancelTool",this.toolName),this.usingToolCard=!this.usingToolCard,this.usingToolCard?(this.styleObject.background=this.activeColor,this.$store.commit(o.u,this.toolName)):(this.styleObject.background="",this.$store.commit(o.l,this.toolName),this.$store.commit(o.g))):this.$emit("enterTool",this.toolName)},handleMouseover:function(){""===this.styleObject.background&&this.usingToolName!==this.toolName&&(this.styleObject.background=this.activeColor)},handleMouseout:function(){this.styleObject.background===this.activeColor&&this.usingToolName!==this.toolName&&(this.styleObject.background="")}},components:{"order-tool":s.a,"bend-tool":i.a,"scale-tool":r.a,"curve-tool":a.a,"link-tool":u.a,"pen-tool":c.a}}},Ao5O:function(t,e,n){"use strict";var o,s=n("bOdI"),i=n.n(s),r=n("vjNh"),a=n("M4fF"),u=(n.n(a),{objectsQueue:[],objectsTree:[],focusObject:{},copiedBuffer:{},count:{storylines:0,customshapes:0,rectangles:0,triangles:0,pentagons:0,hexagons:0,lines:0,echelons:0,circles:0}}),c={objects:function(t){return t.objectsQueue},objectsTree:function(t){return t.objectsTree},focusObject:function(t){return t.focusObject}},l=(o={},i()(o,r.m,function(t,e){e.id=t.objectsQueue.length;var n=0;switch(e.type){case"customshape":n=++t.count.customshapes;break;case"storyline":n=++t.count.storylines;break;case"rectangle":n=++t.count.rectangles;break;case"triangle":n=++t.count.triangles;break;case"pentagon":n=++t.count.pentagons;break;case"hexagon":n=++t.count.hexagons;break;case"echelon":n=++t.count.echelons;break;case"line":n=++t.count.lines;break;case"circle":n=++t.count.circles}"storyline"!==e.type&&(e.name=""+e.type+n),e.id=t.objectsQueue.length,t.objectsQueue.push(e),t.objectsTree.push({name:e.name,children:[e]})}),i()(o,r.n,function(t,e){t.focusObject=e}),i()(o,r.C,function(t,e){t.objectsQueue[e.id].nodes=e.nodes}),o),h={groupObjects:function(t){var e=t.state,n=e.objectsTree;if(n.length>0){var o=[];n.forEach(function(t){t.children.forEach(function(t){t.isSelected&&o.push(t)})}),n.push({name:"group",children:o})}},removeStorylines:function(t){var e=t.state;e.objectsQueue=[],e.objectsTree=[]},scaleFocusObject:function(t){var e=t.state;e.focusObject.activateScale(),e.focusObject.closeMove(),e.focusObject.closeReshape()},reshapeFocusObject:function(t){var e=t.state;e.focusObject.closeScale(),e.focusObject.closeMove(),e.focusObject.activateReshape()},hideFocusObject:function(t){t.state.focusObject.closeShow()},copyFocusObject:function(t){var e=t.state;e.copiedBuffer=e.focusObject},pasteFocusObject:function(t,e){var n=t.state,o=n.copiedBuffer.positionX,s=n.copiedBuffer.positionY,i=e.x,r=e.y,u=i-o,c=r-s,l=a.cloneDeep(n.copiedBuffer);l.id=n.objectsQueue.length,l.move(u,c),l.name+="-copy",n.objectsQueue.push(l),n.objectsTree.push({name:l.name,children:[l]})},cutFocusObject:function(t){var e=t.state;e.copiedBuffer=e.focusObject;for(var n=e.focusObject.id,o=n+1,s=e.objectsQueue.length;o<s;o++){e.objectsQueue[o].id--}e.objectsQueue.splice(n,1)},cancelFocusObject:function(t){var e=t.state;"storyline"!==e.focusObject.type&&e.focusObject.activateMove(),e.focusObject.closeScale(),e.focusObject.closeReshape(),e.focusObject.closeSelect(),e.focusObject={}}};e.a={state:u,getters:c,mutations:l,actions:h}},Ap5A:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"pentagon"},[n("path",{attrs:{d:t.pathD,fill:t.fillColor,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),t._l(t.nodes,function(e,o){return n("controlnode",{directives:[{name:"show",rawName:"v-show",value:t.reshape,expression:"reshape"}],key:o,attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,node:e}})})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},B4Sq:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO");e.a={name:"TreePanel",computed:s()({},Object(i.c)(["objectsTree"]))}},BAdX:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-tool"},[n("icon",{attrs:{name:"plus",scale:"2"}}),t._v(" "),n("input",{attrs:{name:"upload",type:"file"},on:{change:t.handleUpload}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},BYOV:function(t,e,n){"use strict";function o(t){n("6eR/")}var s=n("ip5d"),i=n("Vn2c"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},C84b:function(t,e,n){"use strict";var o,s=n("bOdI"),i=n.n(s),r=n("vjNh"),a={panelActivated:!1,panelName:""},u={panelActivated:function(t){return t.panelActivated},panelName:function(t){return t.panelName}},c=(o={},i()(o,r.r,function(t,e){t.panelActivated=!0,t.panelName=e}),i()(o,r.i,function(t){t.panelActivated=!1,t.panelName=""}),i()(o,r.a,function(t,e){t.panelActivated?(t.panelActivated=!1,t.panelName=""):(t.panelActivated=!0,t.panelName=e)}),i()(o,r.e,function(t,e){t.panelName=e,t.panelActivated=!0}),o);e.a={state:a,getters:u,mutations:c}},CKGA:function(t,e,n){"use strict";var o=n("t3u6"),s=n("6zYt"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},Crh7:function(t,e,n){"use strict";var o=n("j73T"),s=n("Iaoo"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},D4uH:function(t,e,n){"use strict";function o(t){n("tbYJ")}var s=n("dXrS"),i=n("O0jz"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},DLEB:function(t,e,n){"use strict";function o(t,e){for(var n=t.map(function(t){return t.x}),o=t.map(function(t){return t.y}),s=1/(e-1),i=[],r=0;r<e;r++){var a=r*s,u=.5*Math.pow(a-1,2),c=.5*(-2*a*a+2*a+1),l=.5*Math.pow(a,2),h=u*n[0]+c*n[1]+l*n[2],d=u*o[0]+c*o[1]+l*o[2],f=new v.c(h,d);i.push(f)}return i}function s(t,e){var n=[],o=[];t.forEach(function(t){o.push(t.x),o.push(t.y)});for(var s=Object(p.getCurvePoints)(o,.5,e),i=s.length/2,r=0;r<i-1;r++){var a=s[2*r],u=s[2*r+1],c=new v.c(a,u);n.push(c)}return n}n.d(e,"a",function(){return g});var i=n("Zx67"),r=n.n(i),a=n("wxAW"),u=n.n(a),c=n("zwoO"),l=n.n(c),h=n("Pf15"),d=n.n(h),f=n("Zrlr"),m=n.n(f),p=n("gkiq"),v=(n.n(p),n("z4iF")),y=function t(e){m()(this,t),this.points=e},g=function(t){function e(t){m()(this,e);var n=l()(this,(e.__proto__||r()(e)).call(this,t));return n.flatSampleNum=4,n.stepSampleNum=8,n.tension=.15,n}return d()(e,t),u()(e,[{key:"fit",value:function(){for(var t=this.points,e=this.points.slice(),n=0;n<t.length-1;)if(Math.abs(t[n].y-t[n+1].y)<.001){for(var i=n+2;i<t.length-1;i++)if(Math.abs(t[i].y-t[i+1].y)<.001){if(Math.abs(t[n].y-t[i].y)>.001){var r=i-n-1,a=r-1;if(a<0)console.error("middleNode less than 0");else if(a<3){var u=void 0;if(0===a)u=new v.c((t[n+1].x+t[i].x)/2,(t[n+1].y+t[i].y)/2);else{var c=1===a?n+2:n+3;u=new v.c(t[c].x,t[c].y)}var l=o([t[n],t[n+1],u],this.stepSampleNum);l=l.concat(o([u,t[i],t[i+1]],this.stepSampleNum)),e[n+1]=l;for(var h=n+2;h<=n+2+a;h++)e[h]=void 0}else{var d=t.slice(n+1,i+1),f=d.length>3?s(d,2):o(d,(d.length+1)*this.stepSampleNum);e[n+1]=f;for(var m=n+2;m<=i+1;m++)e[m]=void 0}}n=i-1;break}n++}else n++;var p=[];return e.forEach(function(t){t&&(Array.isArray(t)?t.forEach(function(t){p.push(t)}):p.push(t))}),p}}]),e}(y)},DeHT:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO");e.a={name:"StoryPanel",computed:s()({canvasW:function(){return this.paintingCardList[0].width},canvasH:function(){return this.paintingCardList[0].height}},Object(i.c)(["objects","storyConfig","paintingCardList"])),methods:{updateCanvasW:function(t){this.paintingCardList[0].geometry.width=t},updateCanvasH:function(t){this.paintingCardList[0].geometry.height=t},updateXScalingFactor:function(t){this.storyConfig.xScaleFactor=t},updateYScalingFactor:function(t){this.storyConfig.yScaleFactor=t},updateRelaxingFactor:function(t){this.storyConfig.relaxingFactor=t},updateFrameStep:function(t){this.storyConfig.frameStep=t},updateCurveStep:function(t){this.storyConfig.curveStep=t},updateSampleStep:function(t){this.storyConfig.sampleStep=t},updateJitterWave:function(t){this.storyConfig.jitterWave=t}}}},E7qz:function(t,e,n){"use strict";function o(t){n("TdY+")}var s=n("F2Om"),i=n("3zLJ"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},EVPn:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tool-item",style:t.styleObject,on:{mouseover:t.handleMouseover,mouseout:t.handleMouseout,click:function(e){return t.handleClick(e)}}},["OrderTool"===t.toolName?n("div",[n("order-tool")],1):t._e(),t._v(" "),"BendTool"===t.toolName?n("div",[n("bend-tool")],1):t._e(),t._v(" "),"ScaleTool"===t.toolName?n("div",[n("scale-tool")],1):t._e(),t._v(" "),"CurveTool"===t.toolName?n("div",[n("curve-tool")],1):t._e(),t._v(" "),"LinkTool"===t.toolName?n("div",[n("link-tool")],1):t._e(),t._v(" "),"PenTool"===t.toolName?n("div",[n("pen-tool")],1):t._e()])},s=[],i={render:o,staticRenderFns:s};e.a=i},Ef3N:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{staticClass:"move-frame",on:{mouseup:function(e){return t.handleMouseup(e)},mousedown:function(e){return e.stopPropagation(),t.handleMousedown(e)},click:function(t){t.stopPropagation()},contextmenu:function(e){return t.handleContextmenu(e)}}},[n("rotateframe",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},EgXv:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("vjNh"),a=n("rWw5"),u=n("upPS"),c=n("Crh7"),l=n("R/my"),h=n("ewtb"),d=n("X9oV");e.a={name:"SVGCard",props:{mouse:Object,cardObject:Object,scrollX:Number,scrollY:Number},data:function(){return{cardEl:{},storyReorder:null,sessionMover:null,reorderRecordY:0}},computed:s()({cardID:function(){return this.cardObject.ID},cardWidth:function(){return this.cardObject.width},cardHeight:function(){return this.cardObject.height},cardDepth:function(){return this.cardObject.depth},cardPositionX:function(){return this.cardObject.positionX},cardPositionY:function(){return this.cardObject.positionY},styleObject:function(){var t="";return this.isUsingCurveTool&&(t="crosshair"),this.isUsingBendTool&&(t="crosshair"),this.isUsingScaleTool&&(t="crosshair"),this.isUsingTextTool&&(t="text"),{width:this.cardWidth+"px",height:this.cardHeight+"px",padding:this.cardPositionY+"px "+this.cardPositionX+"px",cursor:t}},mouseX:function(){return this.mouse.positionX-this.cardPositionX+this.scrollX},mouseY:function(){return this.mouse.positionY-this.cardPositionY+this.scrollY},mousedownCount:function(){return this.mouse.downCount},mouseupCount:function(){return this.mouse.upCount}},Object(i.c)(["paintingCardList","isUsingCurveTool","isUsingBendTool","isUsingScaleTool","isUsingTextTool","objects","textObjects"])),methods:{handleMousedown:function(){if(this.isUsingTextTool){var t=this.mouse.positionX+this.scrollX,e=this.mouse.positionY+this.scrollY,n=new a.d("text",t,e);this.$store.dispatch("insertTextObject",n),this.$store.commit(r.p,n)}}},mounted:function(){var t=document.getElementsByClassName("painting")[0],e=t.clientWidth,n=t.clientHeight,o=.05*e,s=.02*n,i=e-2*o,a=n-2*s;this.paintingCardList[0].updateGeometry(o,s,i,a),this.$store.commit(r.D,{canvasW:i,canvasH:a})},components:{"visual-object":u.a,"frame-select":c.a,"scale-select":l.a,"path-select":h.a,"text-object":d.a}}},EnH0:function(t,e,n){"use strict";function o(t){n("0bPP")}var s=n("0sPE"),i=n("qOY/"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},F2Om:function(t,e,n){"use strict";e.a={name:"ToolSlider",props:{min:Number,max:Number,step:Number,modelVal:Number},computed:{styleObject:function(){var t=100*(this.modelVal-this.min)/(this.max-this.min);return this.$emit("updateSliderVal",this.modelVal),{backgroundSize:t+"% 100%"}}}}},"GBS+":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("workspace"),t._v(" "),n("side-panel"),t._v(" "),n("side-panelbar"),t._v(" "),n("tool-box")],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},GMF1:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Shifting",expression:"'Shifting'"}]},[n("font-awesome-icon",{attrs:{icon:t.icon}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},Gc5s:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tree-panel"},t._l(t.objectsTree,function(t,e){return n("ul",{key:e},[1==t.children.length?n("tree-node",{attrs:{model:t.children[0]}}):n("tree-node",{attrs:{model:t}})],1)}),0)},s=[],i={render:o,staticRenderFns:s};e.a=i},H5jB:function(t,e,n){"use strict";var o=n("KmDb"),s=n.n(o);e.a={name:"RectFrame",props:{mouseX:Number,mouseY:Number,frameX:Number,frameY:Number,frameW:Number,frameH:Number},data:function(){return{a:0,b:0,c:0,draggedNode:"",frameUpdateCount:0,xMouseInFrame:0,yMouseInFrame:0,rx:0,ry:-30,sin:0,cos:0,updateX:this.frameX||0,updateY:this.frameY||0,updateW:this.frameW||0,updateH:this.frameH||0,oldW:this.frameW||0,oldH:this.frameH||0}},computed:{nodes:function(){return{tPoint:{x:this.updateX+this.updateW/2,y:this.updateY,cursor:{cursor:"n-resize"}},rPoint:{x:this.updateX+this.updateW,y:this.updateY+this.updateH/2,cursor:{cursor:"e-resize"}},bPoint:{x:this.updateX+this.updateW/2,y:this.updateY+this.updateH,cursor:{cursor:"s-resize"}},lPoint:{x:this.updateX,y:this.updateY+this.updateH/2,cursor:{cursor:"w-resize"}},tlPoint:{x:this.updateX,y:this.updateY,cursor:{cursor:"nw-resize"}},trPoint:{x:this.updateX+this.updateW,y:this.updateY,cursor:{cursor:"ne-resize"}},brPoint:{x:this.updateX+this.updateW,y:this.updateY+this.updateH,cursor:{cursor:"se-resize"}},blPoint:{x:this.updateX,y:this.updateY+this.updateH,cursor:{cursor:"sw-resize"}}}},positionX:function(){return this.updateX+this.updateW/2},positionY:function(){return this.updateY+this.updateH/2},rotateNode:function(){return{x:this.positionX+this.rx,y:this.positionY+this.ry}}},methods:{handleMousedown:function(t){this.draggedNode=t,this.xMouseInFrame=this.mouseX-this.updateX,this.yMouseInFrame=this.mouseY-this.updateY,this.oldW=this.updateW,this.oldH=this.updateH},handleMouseup:function(){this.draggedNode="",this.$emit("updateFrame",{x:this.updateX,y:this.updateY,w:this.updateW,h:this.updateH})},handleRotateMousedown:function(){this.draggedNode="circle";var t=this.rotateNode.x-this.positionX,e=this.positionY-this.rotateNode.y,n=s()(t,e);this.sin=t/n,this.cos=e/n},handleRotateMouseup:function(){this.draggedNode="";var t=this.rotateNode.x-this.positionX,e=this.positionY-this.rotateNode.y,n=s()(t,e);this.$emit("rotate",{sin:t/n*this.cos-e/n*this.sin,cos:e/n*this.cos+t/n*this.sin})}},watch:{mouseX:function(t){var e=t-this.xMouseInFrame,n=this.updateW;switch(this.draggedNode){case"rPoint":case"trPoint":case"brPoint":n=this.oldW+e-this.updateX,n>0&&(this.$emit("updateW",n),this.updateW=n);break;case"lPoint":case"tlPoint":case"blPoint":n=this.updateW-(e-this.updateX),n>0&&(this.$emit("updateX",n),this.updateX=e,this.updateW=n);break;case"circle":this.rx=t-this.positionX;var o=this.rotateNode.x-this.positionX,i=this.positionY-this.rotateNode.y,r=s()(o,i);this.$emit("rotate",{sin:o/r*this.cos-i/r*this.sin,cos:i/r*this.cos+o/r*this.sin})}},mouseY:function(t){var e=t-this.yMouseInFrame,n=this.frameH;switch(this.draggedNode){case"tPoint":case"tlPoint":case"trPoint":n=this.updateH-(e-this.updateY),n>0&&(this.$emit("updateY",n),this.updateY=e,this.updateH=n);break;case"bPoint":case"brPoint":case"blPoint":n=this.oldH+(e-this.updateY),n>0&&(this.$emit("updateH",n),this.updateH=n);break;case"circle":this.ry=t-this.positionY;var o=this.rotateNode.x-this.positionX,i=this.positionY-this.rotateNode.y,r=s()(o,i);console.log(o,i,r),this.$emit("rotate",{sin:o/r*this.cos-i/r*this.sin,cos:i/r*this.cos+o/r*this.sin})}},frameX:function(t){this.updateX=t},frameY:function(t){this.updateY=t},frameW:function(t){this.updateW=t},frameH:function(t){this.updateH=t}}}},H6qF:function(t,e,n){"use strict";function o(t){n("QZzn")}var s=n("EgXv"),i=n("ihPm"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},HuY9:function(t,e,n){"use strict";var o,s=n("bOdI"),i=n.n(s),r=n("vjNh"),a={rgba:{r:0,g:0,b:0,a:1}},u={rgba:{r:255,g:255,b:255,a:1}},c={fill:u,stroke:a,strokeWidth:1,opacity:1},l={focusObjectStyle:c,isUsingFillColor:!1,isUsingStrokeColor:!1},h={objectStyle:function(t){return t.focusObjectStyle},isUsingFillColor:function(t){return t.isUsingFillColor},isUsingStrokeColor:function(t){return t.isUsingStrokeColor}},d=(o={},i()(o,r.o,function(t,e){t.focusObjectStyle=e}),i()(o,r.y,function(t){t.focusObjectStyle=c}),i()(o,r.q,function(t){t.isUsingStrokeColor=!1,t.isUsingFillColor=!0}),i()(o,r.h,function(t){t.isUsingFillColor=!1}),i()(o,r.s,function(t){t.isUsingFillColor=!1,t.isUsingStrokeColor=!0}),i()(o,r.j,function(t){t.isUsingStrokeColor=!1}),o);e.a={state:l,getters:h,mutations:d}},IJeS:function(t,e,n){"use strict";var o=n("1N/p");e.a={name:"Rectangle",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],mounted:function(){this.object.isCreate||(this.object.addBezierNode(10,10,10,10),this.object.addBezierNode(100,10,100,10),this.object.addBezierNode(100,100,100,100),this.object.addBezierNode(10,100,10,100),this.object.init())},computed:{nodes:function(){return this.object.nodes},visible:function(){return this.object.isShow},reshape:function(){return this.object.isReshape},pathD:function(){var t="";return this.nodes.forEach(function(e,n){t+=0===n?"M "+e.x+" "+e.y:" L "+e.x+" "+e.y}),this.nodes.length>2&&(t+=" L "+this.nodes[0].x+" "+this.nodes[0].y),t}},components:{controlnode:o.a}}},Iaoo:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.isUsingFrameSelect,expression:"isUsingFrameSelect"}],staticClass:"group-select"},t._l(t.linesNum,function(e){return n("line",{key:e,attrs:{x1:t.sPoints[e-1].x,y1:t.sPoints[e-1].y,x2:t.ePoints[e-1].x,y2:t.ePoints[e-1].y,stroke:"red","stroke-width":"10",opacity:"0.5"}})}),0)},s=[],i={render:o,staticRenderFns:s};e.a=i},IcnI:function(t,e,n){"use strict";var o,s=n("bOdI"),i=n.n(s),r=n("7+uW"),a=n("NYxO"),u=n("HuY9"),c=n("Ao5O"),l=n("yO/d"),h=n("hSCs"),d=n("O9ke"),f=n("C84b"),m=n("M7H2"),p=n("vjNh");r.a.use(a.a);var v={isObjectsActiveChange:!1,usingToolName:""},y={isObjectsActiveChange:function(t){return t.isObjectsActiveChange},usingToolName:function(t){return t.usingToolName}},g=(o={},i()(o,p.w,function(t){t.isObjectsActiveChange=!t.isObjectsActiveChange}),i()(o,p.f,function(t,e){t.usingToolName=e}),o);e.a=new a.a.Store({modules:{StyleStore:u.a,ObjectStore:c.a,ToolStore:l.a,TextStore:h.a,CardStore:d.a,PanelStore:f.a,StoryStore:m.a},state:v,getters:y,mutations:g})},J4kB:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;return(t._self._c||e)("scaleframe",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount},on:{rotate:function(e){return t.rotate(e)}}})},s=[],i={render:o,staticRenderFns:s};e.a=i},Kj9C:function(t,e,n){"use strict";var o=n("1N/p");e.a={name:"Echelon",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],mounted:function(){this.object.isCreate||(this.object.addBezierNode(125,100,125,100),this.object.addBezierNode(175,100,175,100),this.object.addBezierNode(200,200,200,200),this.object.addBezierNode(100,200,100,200),this.object.init())},computed:{nodes:function(){return this.object.nodes},visible:function(){return this.object.isShow},reshape:function(){return this.object.isReshape},pathD:function(){var t="";return this.nodes.forEach(function(e,n){t+=0===n?"M "+e.x+" "+e.y:" L "+e.x+" "+e.y}),this.nodes.length>2&&(t+=" L "+this.nodes[0].x+" "+this.nodes[0].y),t}},components:{controlnode:o.a}}},KuhB:function(t,e,n){"use strict";var o=n("1N/p");e.a={name:"Hexagon",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],mounted:function(){this.object.isCreate||(this.object.addBezierNode(100,10,100,10),this.object.addBezierNode(200,10,200,10),this.object.addBezierNode(250,96.5,250,96.5),this.object.addBezierNode(200,183,100,183),this.object.addBezierNode(100,183,100,183),this.object.addBezierNode(50,96.5,50,96.5),this.object.init())},computed:{nodes:function(){return this.object.nodes},visible:function(){return this.object.isShow},reshape:function(){return this.object.isReshape},pathD:function(){var t="";return this.nodes.forEach(function(e,n){t+=0===n?"M "+e.x+" "+e.y:" L "+e.x+" "+e.y}),this.nodes.length>2&&(t+=" L "+this.nodes[0].x+" "+this.nodes[0].y),t}},components:{controlnode:o.a}}},L8V5:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n("Zrlr"),s=n.n(o),i=n("wxAW"),r=n.n(i),a=n("z4iF"),u=function(){function t(){s()(this,t)}return r()(t,null,[{key:"sample",value:function(t,e){for(var n=[],o=1;o<t.length;o++)for(var s=t[o-1],i=t[o],r=Math.atan2(i.y-s.y,i.x-s.x),u=Math.sin(r)*e,c=Math.cos(r)*e,l=s.x,h=s.y;l<i.x;l+=c,h+=u)n.push(new a.c(l,h));return n.push(t[t.length-1]),n}},{key:"jitter",value:function(e,n){for(var o=1;o<e.length;o++){var s=e[o-1],i=e[o],r=t.randomJitter(n),a=Math.atan2(i.y-s.y,i.x-s.x)+Math.PI/2,u=Math.sin(a)*r,c=Math.cos(a)*r;e[o].y+=u,e[o].x+=c}return e}},{key:"randomJitter",value:function(t){return(Math.random()-.5)*t}}]),t}()},M7H2:function(t,e,n){"use strict";function o(t,e,n){var o=!0;t.forEach(function(t){t.item1===e&&(t.item2=n,o=!1)}),o&&t.push({item1:e,item2:n})}function s(t,e,n,o){for(var s=[],i=0,r=n.length;i<r;i++){var a=n[i].points[t].item3;a>0&&s.push({id:i,yPos:a})}s.sort(function(t,e){return e.yPos-t.yPos});for(var u=-1,c=0,l=s.length;c<l;c++){o[s[c].id][t]===e&&c<l-1&&(u=o[s[c+1].id][t])}return u===e?9999:u}function i(t,e){var n=new x.a,o=[];t.forEach(function(t){n.set(t.item1,t.item2)}),e.forEach(function(t){n.set(t.item1,t.item2)});var s=!0,i=!1,r=void 0;try{for(var a,u=h()(n);!(s=(a=u.next()).done);s=!0){var c=a.value,l=f()(c,2),d=l[0],m=l[1];o.push({item1:d,item2:m})}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}return o}function r(t,e){var n=new x.a,o=[];t.forEach(function(t){var e=t.item1.item1<t.item1.item2?t.item1.item1:t.item1.item2,o=t.item1.item1>t.item1.item2?t.item1.item1:t.item1.item2;if(o>e){n.has(e)||n.set(e,new x.a);n.get(e).set(o,t.item2)}}),e.forEach(function(t){var e=t.item1.item1<t.item1.item2?t.item1.item1:t.item1.item2,o=t.item1.item1>t.item1.item2?t.item1.item1:t.item1.item2;if(o>e){n.has(e)||n.set(e,new x.a);var s=n.get(e);s.has(o)?s.set(o,{item1:t.item2.item1,item2:-1}):s.set(o,t.item2)}});var s=!0,i=!1,r=void 0;try{for(var a,u=h()(n);!(s=(a=u.next()).done);s=!0){var c=a.value,l=f()(c,2),d=l[0],m=l[1],p=!0,v=!1,y=void 0;try{for(var g,b=h()(m);!(p=(g=b.next()).done);p=!0){var C=g.value,w=f()(C,2),_=w[0],k=w[1];o.push({item1:{item1:d,item2:_},item2:k})}}catch(t){v=!0,y=t}finally{try{!p&&b.return&&b.return()}finally{if(v)throw y}}}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}return o}function a(t,e){var n=new x.a,o=[];t.forEach(function(t){n.has(t[0])||n.set(t[0],new x.a),n.get(t[0]).set(t[1],1)}),e.forEach(function(t){if(n.has(t[1])){var e=n.get(t[1]);e.has(t[0])&&e.set(t[0],0)}n.has(t[0])||n.set(t[0],new x.a),n.get(t[0]).set(t[1],1)});var s=!0,i=!1,r=void 0;try{for(var a,u=h()(n);!(s=(a=u.next()).done);s=!0){var c=a.value,l=f()(c,2),d=l[0],m=l[1],p=!0,v=!1,y=void 0;try{for(var g,b=h()(m);!(p=(g=b.next()).done);p=!0){var C=g.value,w=f()(C,2),_=w[0];1===w[1]&&d!==_&&o.push([d,_])}}catch(t){v=!0,y=t}finally{try{!p&&b.return&&b.return()}finally{if(v)throw y}}}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}return o}function u(t,e){var n=[],o=new x.a;t.forEach(function(t){var e=t.frame,n=t.session1,s=t.session2;if(o.has(e)){o.get(e).set(n,s)}else{var i=new x.a;i.set(n,s),o.set(e,i)}}),e.forEach(function(t){var e=t.frame,n=t.session1,s=t.session2;if(o.has(e)){o.get(e).set(n,s)}else{var i=new x.a;i.set(n,s),o.set(e,i)}});var s=!0,i=!1,r=void 0;try{for(var a,u=h()(o);!(s=(a=u.next()).done);s=!0){var c=a.value,l=f()(c,2),d=l[0],m=l[1],p=!0,v=!1,y=void 0;try{for(var g,b=h()(m);!(p=(g=b.next()).done);p=!0){var C=g.value,w=f()(C,2),_=w[0],k=w[1];n.push({frame:d,session1:_,session2:k})}}catch(t){v=!0,y=t}finally{try{!p&&b.return&&b.return()}finally{if(v)throw y}}}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}return n}var c,l=n("BO1k"),h=n.n(l),d=n("d7EF"),f=n.n(d),m=n("Xxa5"),p=n.n(m),v=n("exGp"),y=n.n(v),g=n("bOdI"),b=n.n(g),C=n("ifoU"),x=n.n(C),w=n("vjNh"),_=n("rWw5"),k=n("76OO"),S=n("puZo"),T=n("iJRs"),j=n("M4fF"),N=(n.n(j),n("mtWM")),P=n.n(N),Y=P.a.create({baseURL:"http://localhost:5050/api/"}),O={storylines:[],storylinesBak:[],rawStorylines:[],frameTable:new x.a,sessionTable:[],permTable:[],characterTable:new x.a,storylineTable:new x.a,dashRangeMap:[],targetPath:[],focusCharacters:[],twineCharacters:[],twineRange:[],twineUsed:!1,selectedCharacters:[],selectedFrames:[],storyConfig:{paddingTop:100,paddingLeft:400,paddingBottom:100,paddingRight:100,xScaleFactor:1,yScaleFactor:1,relaxingFactor:60,frameStep:120,curveStep:160,canvasW:1800,canvasH:860,curveTheta:30/180*Math.PI,sampleStep:5,jitterWave:1e-5,content:""},frameSteps:[],curveSteps:[],request:{id:"",sessionInnerGap:18,sessionOuterGap:54,sessionInnerGaps:[],sessionOuterGaps:[],majorCharacters:[],orders:[],groupIds:[],selectedSessions:[],orderTable:[],sessionBreaks:[]},history:[]},X={identifier:function(t){return t.request.identifier},request:function(t){return t.request},storyConfig:function(t){return t.storyConfig},storylines:function(t){return t.storylines},targetPath:function(t){return t.targetPath},storyFrameMap:function(t){return t.frameTable},storySessionMap:function(t){return t.sessionTable},storyCharacterMap:function(t){return t.characterTable},dashRangeMap:function(t){return t.dashRangeMap},selectedCharacters:function(t){return t.selectedCharacters},selectedFrames:function(t){return t.selectedFrames},twineCharacters:function(t){return t.twineCharacters},history:function(t){return t.history},twineUsed:function(t){return t.twineUsed}},E=(c={},b()(c,w.B,function(t,e){t.request=e}),b()(c,w.b,function(t,e){-1===t.focusCharacters.indexOf(e)&&t.focusCharacters.push(e)}),b()(c,w.d,function(t,e){-1===t.selectedCharacters.indexOf(e)&&t.selectedCharacters.push(e)}),b()(c,w.g,function(t,e){t.selectedCharacters=[]}),b()(c,w.v,function(t,e){t.targetPath=e}),b()(c,w.D,function(t,e){t.storyConfig.canvasW=e.canvasW,t.storyConfig.canvasH=e.canvasH}),b()(c,w.c,function(t){t.history.push({storylines:j.cloneDeep(t.storylines),request:j.cloneDeep(t.request)})}),c),M=b()({uploadXMLFile:function(t,e){var n=this,o=t.state,s=t.dispatch;return y()(p.a.mark(function t(){var i,r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=new FormData,i.append("file",e),t.next=4,Y.post("/upload",i);case 4:r=t.sent,0===r.data.error&&(o.request.id=r.data.data.identifier,s("layoutStoryline"));case 6:case"end":return t.stop()}},t,n)}))()},layoutStoryline:function(t){var e=this,n=t.state,o=t.commit,s=t.dispatch;return y()(p.a.mark(function t(){var i,r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.post("/update",n.request);case 2:i=t.sent,0===i.data.error&&(n.rawStorylines=i.data.data.array,n.sessionTable=i.data.data.sessionTable,n.permTable=i.data.data.perm,s("anchorStorylines"),s("updateFrameCurveSteps"),s("updateStorySize"),r=new k.a(n.rawStorylines,n.sessionTable,n.frameSteps,n.curveSteps,n.storyConfig),n.storylines=r.generateStorylines(),s("updateFrameTable"),s("updateCharacterTable"),n.storylines.forEach(function(t){var e=new _.c("storyline");e.name=t.name,e.nodes=t.points,e.characterId=t.characterId,o(w.m,e),n.storylineTable.set(t.name,e.id)}));case 4:case"end":return t.stop()}},t,e)}))()},updateStoryline:function(t){var e=this,n=t.state,o=t.commit,s=t.dispatch;return y()(p.a.mark(function t(){var i,r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.post("/update",n.request);case 2:i=t.sent,0===i.data.error&&(n.storylines.length>0?(n.rawStorylines=i.data.data.array,n.sessionTable=i.data.data.sessionTable,n.permTable=i.data.data.perm,s("anchorStorylines"),s("updateStorySize"),r=new k.a(n.rawStorylines,n.sessionTable,n.frameSteps,n.curveSteps,n.storyConfig),n.storylines=r.generateStorylines(),s("updateFrameTable"),s("updateCharacterTable"),n.storylines.forEach(function(t){var e=n.storylineTable.get(t.name);o(w.C,{id:e,nodes:t.points})})):s("layoutStoryline"),o(w.c));case 4:case"end":return t.stop()}},t,e)}))()},anchorStorylines:function(t){var e=t.state,n=e.sessionTable[0].length,o=e.sessionTable.length;if(n>0){for(var s=9999,i=0;i<n;i++)for(var r=0;r<o;r++)if(1===e.permTable[r][i]){var a=e.rawStorylines[r].points[i].item3;s=a<s?a:s}var u=s-e.storyConfig.paddingTop;e.rawStorylines.forEach(function(t){var e=t.points;"RABBIT"!==t.name&&e.forEach(function(t){t.item3>0&&(t.item3-=u)})})}},updateFrameCurveSteps:function(t){var e=t.state,n=e.storyConfig.frameStep,o=e.storyConfig.curveStep,s=e.sessionTable[0].length;e.frameSteps=Array.apply(null,{length:s}).map(function(t,e){return n}),e.curveSteps=Array.apply(null,{length:s}).map(function(t,e){return o})},updateStorySize:function(t){var e=t.state,n=0;e.frameSteps.forEach(function(t){n+=t}),e.curveSteps.forEach(function(t){n+=t}),e.storyConfig.xScaleFactor=.6*(e.storyConfig.canvasW-e.storyConfig.paddingLeft-e.storyConfig.paddingRight)/n},updateFrameTable:function(t){for(var e=t.state,n=e.storylines,o=e.sessionTable[0].length,s=e.sessionTable.length,i=new x.a,r=0;r<o;r++){for(var a=1e4,u=0,c=2*r,l=c+1,h=0;h<s;h++){var d=n[h].points[c].x,f=n[h].points[l].x;a=a<d?a:d,u=u>f?u:f}i.set(r,[a,u])}for(var m=0;m<o;m++){var p=i.get(m),v=-1,y=-1;if(0===m){var g=i.get(m+1);v=p[0],y=(p[1]+g[0])/2}else if(m===o-1){var b=i.get(m-1);v=(p[0]+b[1])/2,y=p[1]}else{var C=i.get(m-1),w=i.get(m+1);v=(p[0]+C[1])/2,y=(p[1]+w[0])/2}e.frameTable.set(m,[v,y])}},updateCharacterTable:function(t){for(var e=t.state,n=e.rawStorylines,o=e.storyConfig.yScaleFactor,s=e.storyConfig.paddingTop,i=0,r=n[0].points.length;i<r;i++)e.characterTable.set(i,new x.a);for(var a=0,u=n.length;a<u;a++)for(var c=0,l=n[a].points.length;c<l;c++){var h=e.characterTable.get(c),d=n[a].points[c].item3;d>0&&(d=n[a].points[c].item3*o+s,h.set(a,d))}},orderStoryline:function(t,e){var n=t.state,o=t.dispatch;if(e<n.sessionTable.length-1){var s=[],i=new x.a;n.storylines.forEach(function(t){for(var e=0,n=t.points.length;e<n;e++){var o=t.points[e].y;if(o>-1e4){i.set(t.characterId,o);break}}});var r=i.get(e),u=!0,c=!1,l=void 0;try{for(var d,m=h()(i);!(u=(d=m.next()).done);u=!0){var p=d.value,v=f()(p,2),y=v[0],g=v[1];y!==e&&y!==n.sessionTable.length-1&&(g>r?s.push([e,y]):g>=0?s.push([y,e]):s.push([e,y]))}}catch(t){c=!0,l=t}finally{try{!u&&m.return&&m.return()}finally{if(c)throw l}}var b=n.request.orders,C=s;n.request.orders=a(b,C)}o("updateStoryline")},orderSession:function(t,e){var n=t.state,o=t.dispatch,s=!0;n.request.orderTable.forEach(function(t){t.item1===e.frame&&(t.item2=e.order,s=!1)}),s&&n.request.orderTable.push({item1:e.frame,item2:e.order}),o("updateStoryline")},reshapeCharacters:function(t,e){var n=t.state,o=(t.dispatch,n.selectedCharacters),s=e.length;if(o.length>0&&s>0){n.storylinesBak=j.cloneDeep(n.storylines);new T.a(n.storylines,n.sessionTable,n.frameTable,n.storyConfig,e).reshapeCharacters(o)}},cancelReshape:function(t){var e=t.state;e.storylinesBak.length>0&&e.storylines.forEach(function(t,n){var o=t.points,s=e.storylinesBak[n].points;o.forEach(function(t,e){t.y=s[e].y,t.isOptimized=s[e].isOptimized})})},selectFrames:function(t,e){var n=t.state;t.dispatch;if(n.selectedCharacters.length>0){n.selectedFrames=[];for(var o=new S.e(n.frameTable,n.sessionTable,n.characterTable),s=e.sPoints,i=e.ePoints,r=e.linesNum,a=0;a<r;a++){var u=o.matchFrame(s[a].x,s[a].y),c=o.matchFrame(i[a].x,i[a].y);u>-1&&c>-1&&n.selectedFrames.push([u,c])}}},straightenCharacter:function(t,e){var n=t.state,s=t.dispatch;if(n.focusCharacters.length>0){for(var i=new S.e(n.frameTable,n.sessionTable,n.characterTable),r=n.focusCharacters,a=e.sPoints,u=e.ePoints,c=e.linesNum,l=0;l<c;l++)!function(t){var e=i.matchFrame(a[t].x,a[t].y),s=i.matchFrame(u[t].x,u[t].y),c=s-e+1,l=Array.apply(null,{length:c}).map(function(t,n){return e++}),h=n.request.majorCharacters;r.forEach(function(t){o(h,t,l)})}(l);s("updateStoryline"),n.focusCharacters=[]}else s("breakSession",e)},breakSession:function(t,e){for(var n=t.state,o=t.dispatch,i=new S.e(n.frameTable,n.sessionTable,n.characterTable),r=e.sPoints,a=e.ePoints,c=e.linesNum,l=n.sessionTable,h=[],d=[],f=0;f<c;f++){var m=i.matchFrame(r[f].x,r[f].y);if(m>-1){var p=i.matchCharacterR(m,r[f].y);if(p>-1){for(var v=l[p][m],y=v,g=m;m>-1&&y===v;)y=l[p][--m];y=-1===m?v:y,m=-1===m?g-1:m;var b=s(m+1,v,n.rawStorylines,l);if(m>-1&&b>-1){h.push({session1:y,session2:v,frame:m});var C=a[f].y>r[f].y?1.2*(a[f].y-r[f].y):20;d.push({item1:{item1:v,item2:b},item2:{item1:C,item2:-1}})}}}}var x=n.request.sessionBreaks;n.request.sessionBreaks=u(x,h),h.length>0&&o("updateStoryline")},brushingCharacter:function(t,e){var n=t.state;t.dispatch;if(n.dashRangeMap=[],n.selectedCharacters.length>0)for(var o=e.sPoints,s=e.ePoints,i=e.linesNum,r=0;r<i;r++)n.dashRangeMap.push([o[r].x,s[r].x])},twineCharacters:function(t,e){var n=t.state,o=t.commit;t.dispatch;console.log("twine");var s=[500,1e4],i=[2,3],r=[n.storylines[i[0]],n.storylines[i[1]]],a=r[0].points.slice(),u=r[1].points.slice();a.forEach(function(t,e,n){if(s[0]<t.x&&t.x<s[1]&&(e%4==0||e%4==1)){var o=u[e];u[e]=t,n[e]=o}}),r[0].points=a,r[1].points=u,r.forEach(function(t){var e=n.storylineTable.get(t.name);o(w.C,{id:e,nodes:t.points})})},scaleSession:function(t,e){var n=(t.state,t.dispatch),o=e.sPoints[0],s=e.ePoints[0];Math.abs(o.x-s.x)<Math.abs(o.y-s.y)?n("scaleSessionVertical",e):n("scaleSessionHorizontal",e)},scaleSessionVertical:function(t,e){var n=t.state,o=t.dispatch,s=e.sPoints,a=e.ePoints;if(2===e.linesNum){var u=new S.a(n.rawStorylines,n.frameTable,n.sessionTable,n.characterTable,n.request,n.storyConfig),c=u.buildSessionConstraints(s,a);if(s[0].y>a[0].y){var l=n.request.sessionInnerGaps,h=c.sessionInnerGaps;n.request.sessionInnerGaps=i(l,h),console.log("vertical scale innergap"),o("updateStoryline")}else if(s[0].y<a[0].y){var d=n.request.sessionOuterGaps,f=c.sessionOuterGaps;n.request.sessionOuterGaps=r(d,f),console.log("vertical scale outergap"),o("updateStoryline")}}},scaleSessionHorizontal:function(t,e){var n=t.state,o=t.dispatch,s=t.commit,i=new S.b(n.frameTable,n.sessionTable,n.characterTable,n.frameSteps,n.curveSteps),r=e.sPoints,a=e.ePoints;i.scale(r,a),o("updateStorySize");var u=new k.a(n.rawStorylines,n.sessionTable,n.frameSteps,n.curveSteps,n.storyConfig);n.storylines=u.generateStorylines(),o("updateFrameTable"),n.storylines.forEach(function(t){var e=n.storylineTable.get(t.name);s(w.C,{id:e,nodes:t.points})})}},w.A,function(t){var e=t.state,n=(t.dispatch,t.commit);if(e.history.length>0){var o=e.history[e.history.length-1];e.storylines=o.storylines,e.storylines.forEach(function(t){var o=e.storylineTable.get(t.name);n(w.C,{id:o,nodes:t.points})}),e.request=o.request,e.history.splice(-1,1)}});e.a={state:O,getters:X,actions:M,mutations:E}},M93x:function(t,e,n){"use strict";function o(t){n("Naw1")}var s=n("xJD8"),i=n("GBS+"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},MIrv:function(t,e,n){"use strict";function o(t){n("tS/o")}var s=n("B4Sq"),i=n("Gc5s"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},Mcgq:function(t,e,n){"use strict";e.a={name:"ContextMenu",props:["recordX","recordY","scrollX","scrollY"],data:function(){return{states:["Hide","Scale","Reshape","Copy","Paste","Group","Ungroup","Cancel"]}},computed:{position:function(){return{top:this.recordY+"px",left:this.recordX+"px"}}},methods:{handleClick:function(t){switch(t){case"Reshape":this.$store.dispatch("reshapeFocusObject");break;case"Scale":this.$store.dispatch("scaleFocusObject");break;case"Hide":this.$store.dispatch("hideFocusObject");break;case"Cancel":this.$store.dispatch("cancelFocusObject");break;case"Copy":this.$store.dispatch("copyFocusObject");break;case"Paste":this.$store.dispatch("pasteFocusObject",{x:this.recordX+this.scrollX,y:this.recordY+this.scrollY});break;case"Cut":this.$store.dispatch("cutFocusObject");break;case"Group":this.$store.dispatch("groupObjects")}}}}},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),s=n("M93x"),i=n("IcnI"),r=(n("W7Cb"),n("Xd4/"),n("3Uos"),n("j4GK"),n("6Wiw"),n("S0TK"),n("vASM"),n("0My8"),n("g0T0"),n("2PPF"),n("t+cJ"),n("LjeE"),n("B8Lx"),n("nhyU"),n("aH8d"),n("3fLA"),n("r8MY"),n("rcsw"),n("g+VN"),n("D4uH")),a=n("EnH0"),u=n("E7qz"),c=n("U0v6"),l=n.n(c),h=n("VN6J");o.a.directive("tooltip",h.c),o.a.directive("close-popover",h.a),o.a.component("v-popover",h.b),o.a.component("icon",r.a),o.a.component("tree-node",a.a),o.a.component("tool-slider",u.a),o.a.component("font-awesome-icon",l.a),o.a.config.productionTip=!1,new o.a({el:"#app",store:i.a,template:"<App/>",components:{App:s.a,Icon:r.a}})},NZGm:function(t,e,n){"use strict";function o(t){n("kcJT")}var s=n("9iOO"),i=n("24zk"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},Naw1:function(t,e){},O0jz:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{class:t.klass,style:t.style,attrs:{version:"1.1",role:t.label?"img":"presentation","aria-label":t.label,x:t.x,y:t.y,width:t.width,height:t.height,viewBox:t.box}},[t._t("default",[t.icon&&t.icon.paths?t._l(t.icon.paths,function(e,o){return n("path",t._b({key:"path-"+o},"path",e,!1))}):t._e(),t._v(" "),t.icon&&t.icon.polygons?t._l(t.icon.polygons,function(e,o){return n("polygon",t._b({key:"polygon-"+o},"polygon",e,!1))}):t._e(),t._v(" "),t.icon&&t.icon.raw?[n("g",{domProps:{innerHTML:t._s(t.raw)}})]:t._e()])],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},O1zv:function(t,e,n){"use strict";var o=n("flRY"),s=n("Ap5A"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},O6Ek:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var o=n("BO1k"),s=n.n(o),i=n("d7EF"),r=n.n(i),a=n("Zrlr"),u=n.n(a),c=n("wxAW"),l=n.n(c),h=function(){function t(e,n,o){u()(this,t),this.data=e,this.sessionTable=n,this.storyConfig=o}return l()(t,[{key:"twist",value:function(e){var n=this;this.validateData()||console.error("invalid input data");for(var o=this.data,i=(this.sessionTable,this.data[0].points.length/2),a=this.data.length,u=[],c=0;c<i;c++){for(var l=2*c+1,h=[],d=0;d<a;d++)h.push({character:d,y:o[d].points[l].y});h.sort(function(t,e){return t.y-e.y}),u.push(h)}for(var f=0;f<i-1;f++)!function(i){var a=2*i+1,c=a+2,l=u[i],h=(u[i+1],[]),d=[],f=[],m=[],p=0,v=-1,y=-1;l.forEach(function(t,e){var n=t.character,s=t.y,i=o[n].points[c].y,r=0;if(s>-1&&i>-1&&(r=Math.round(i-s)),!(Math.abs(r)<1e-4)){1===(r>0?1:-1)?(-1===p&&f.length>0&&(h.push(f),f=[]),-1===v||-1===y?(m.push(n),v=r):Math.abs(v-r)<100&&Math.abs(s-y)<100?m.push(n):(d.push(m),m=[n],v=r),p=1):(1===p&&m.length>0&&(d.push(m),m=[]),-1===v||-1===y?(f.push(n),v=r):Math.abs(v-r)<100&&Math.abs(s-y)<100?f.push(n):(h.push(f),f=[n],v=r),f.push(n),p=-1),y=s}}),f.length>0&&(h.push(f),f=[]),m.length>0&&(d.push(m),m=[]);var g=n.cleanUpDownSet(h,d),b=r()(g,2);h=b[0],d=b[1];var C=0,x=!0,w=!1,_=void 0;try{for(var k,S=s()(h);!(x=(k=S.next()).done);x=!0){var T=k.value;C=Math.max(t.internalTwist(T,e,-1,o,a),C)}}catch(t){w=!0,_=t}finally{try{!x&&S.return&&S.return()}finally{if(w)throw _}}var j=!0,N=!1,P=void 0;try{for(var Y,O=s()(d);!(j=(Y=O.next()).done);j=!0){var X=Y.value;C=Math.max(t.internalTwist(X,e,1,o,a),C)}}catch(t){N=!0,P=t}finally{try{!j&&O.return&&O.return()}finally{if(N)throw P}}var E=!0,M=!1,U=void 0;try{for(var F,B=s()(o);!(E=(F=B.next()).done);E=!0)for(var R=F.value,z=c;z<R.points.length;z++)R.points[z].x+=C}catch(t){M=!0,U=t}finally{try{!E&&B.return&&B.return()}finally{if(M)throw U}}}(f);this.fixWrongPosition(o),this.scalePosition(o)}},{key:"fixWrongPosition",value:function(t){for(var e=t.length,n=t[0].points.length,o=0;o<n-1;o++){for(var s=1e3,i=0;i<e;i++){var r=t[i].points[o].y,a=t[i].points[o+1].y;if(r>-1&&a>-1){var u=t[i].points[o+1].x-t[i].points[o].x;s=Math.min(s,u)}}if(s<0)for(var c=20-s,l=o+1;l<n;l++)for(var h=0;h<e;h++)t[h].points[l].x+=c}}},{key:"scalePosition",value:function(t){for(var e=t[0].points.length-1,n=t[0].points[0].x,o=0,s=0,i=t.length;s<i;s++){var r=t[s].points[e].x;o=o>r?o:r}var a=this.storyConfig.paddingLeft,u=(this.storyConfig.canvasW-a-this.storyConfig.paddingRight)/(o-n);u<1&&t.forEach(function(t){t.points.forEach(function(t){t.x*=u})})}},{key:"cleanUpDownSet",value:function(t,e){var n=[],o=[];return t.forEach(function(t){var e=[];t.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),n.push(e)}),e.forEach(function(t){var e=[];t.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),o.push(e)}),[n,o]}},{key:"validateData",value:function(){var t=this.data;if(!t)return!1;var e=-1,n=!0,o=!1,i=void 0;try{for(var r,a=s()(t);!(n=(r=a.next()).done);n=!0){var u=r.value,c=u.points.length;if(c%2!=0)return!1;if(-1===e)e=c;else if(c!==e)return!1}}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return!0}}],[{key:"calculateMoveDistance",value:function(t,e){return t*Math.tan(e/2)}},{key:"internalTwist",value:function(e,n,o,s,i){var r=0,a=i+1,u=i+2;if(0!==o&&e.length>1){var c=-1===o,l=c?e[0]:e[e.length-1],h=s[l].points[a].x-s[l].points[i].x;if(c)for(var d=1;d<e.length;d++){var f=e[d],m=e[d-1],p=s[f].points[u].y-s[f].points[i].y,v=s[f].points[i].y-s[m].points[i].y,y=Math.abs(t.calculateMoveDistance(v,Math.atan2(p,h))),g=y*n;s[f].points[i].x=s[m].points[i].x+g,s[f].points[a].x=s[m].points[a].x+g,r=Math.max(g,r)}else for(var b=e.length-2;b>=0;b--){var C=e[b],x=s[l].points[i].y-s[C].points[i].y,w=s[C].points[u].y-s[C].points[i].y,_=Math.abs(t.calculateMoveDistance(x,Math.atan2(w,h))),k=_*n;s[C].points[i].x+=k,s[C].points[a].x+=k,r=Math.max(k,r)}}return r}}]),t}()},O9ke:function(t,e,n){"use strict";var o=n("Wt/O"),s={paintingCardList:[],paintingCardCount:0},i={paintingCardCount:function(t){return t.paintingCardCount},paintingCardList:function(t){return t.paintingCardList}},r={},a={addPaintingCard:function(t){var e=t.state,n=e.paintingCardCount++,s=new o.a(n);e.paintingCardList.push(s)}};e.a={state:s,getters:i,mutations:r,actions:a}},"Oky+":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Twining",expression:"'Twining'"}]},[n("font-awesome-icon",{attrs:{icon:t.icon,transform:"shrink1.5"}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},PCxI:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-panel"},[n("div",{staticClass:"font-wrapper"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.focusText.fontSize,expression:"focusText.fontSize"}],attrs:{type:"text",name:"fontSize",placeholder:"font size"},domProps:{value:t.focusText.fontSize},on:{input:function(e){e.target.composing||t.$set(t.focusText,"fontSize",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"font-wrapper"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.focusText.fontFamily,expression:"focusText.fontFamily"}],attrs:{type:"text",name:"fontFamily",placeholder:"font family"},domProps:{value:t.focusText.fontFamily},on:{input:function(e){e.target.composing||t.$set(t.focusText,"fontFamily",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"font-wrapper"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.focusText.color,expression:"focusText.color"}],attrs:{type:"text",name:"textColor",placeholder:"text color"},domProps:{value:t.focusText.color},on:{input:function(e){e.target.composing||t.$set(t.focusText,"color",e.target.value)}}})]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.focusText.content,expression:"focusText.content"}],attrs:{name:"textContent",cols:"30",rows:"10",placeholder:"insert text content"},domProps:{value:t.focusText.content},on:{input:function(e){e.target.composing||t.$set(t.focusText,"content",e.target.value)}}})])},s=[],i={render:o,staticRenderFns:s};e.a=i},QZzn:function(t,e){},QsEu:function(t,e,n){"use strict";var o=n("Y2jX"),s=n.n(o);e.a={name:"BendTool",computed:{icon:function(){return s.a}}}},"R/my":function(t,e,n){"use strict";var o=n("3eZz"),s=n("rNQu"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},SQ8e:function(t,e,n){"use strict";var o=n("mZf6"),s=n.n(o);e.a={name:"LinkTool",computed:{icon:function(){return s.a}}}},Skty:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;return(t._self._c||e)("rect",{attrs:{x:t.node.x-t.squareSize/2,y:t.node.y-t.squareSize/2,width:t.squareSize,height:t.squareSize,fill:"white",stroke:"black","stroke-width":"1"},on:{mousedown:function(e){return t.handleMousedown(e)},click:t.handleClick,contextmenu:t.handleContextmenu}})},s=[],i={render:o,staticRenderFns:s};e.a=i},"TdY+":function(t,e){},U02f:function(t,e,n){"use strict";var o=n("9Dxg");e.a={name:"RotateFrame",props:["mouseX","mouseY","mousedownCount","mouseupCount","object"],data:function(){return{sin:0,cos:0}},computed:{nodes:function(){return this.object.nodes}},methods:{rotate:function(t){var e=t.sin,n=t.cos;this.sin=e,this.cos=n,this.object.rotate(e,n)}},components:{scaleframe:o.a}}},Ui19:function(t,e){},UiOb:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Save",expression:"'Save'"}],staticClass:"save-tool",on:{click:t.handleClick}},[n("icon",{attrs:{name:"save",scale:"1.5"}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},Vn2c:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Undo",expression:"'Undo'"}],staticClass:"undo-tool",on:{click:t.handleClick}},[n("icon",{attrs:{name:"rotate-left",scale:"1.5"}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},W1Js:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Scaling",expression:"'Scaling'"}]},[n("font-awesome-icon",{attrs:{icon:t.icon}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},WZ6U:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"workspace"},on:{click:function(e){return t.handleClick(e)},contextmenu:function(e){return t.handleContextmenu(e)},mousemove:function(e){return t.handleMousemove(e)},mousedown:function(e){return t.handleMousedown(e)},mouseup:function(e){return t.handleMouseup(e)}}},[n("div",{staticClass:"painting",on:{scroll:t.handleScroll}},t._l(t.paintingCardList,function(e){return n("svg-card",{key:e.id,attrs:{cardObject:e,scrollX:t.paintingScrollX,scrollY:t.paintingScrollY,mouse:t.mouse}})}),1),t._v(" "),n("context-menu",{directives:[{name:"show",rawName:"v-show",value:t.isShowContextMenu,expression:"isShowContextMenu"}],attrs:{scrollX:t.paintingScrollX,scrollY:t.paintingScrollY,recordX:t.contextMenuPositionX,recordY:t.contextMenuPositionY}}),t._v(" "),n("color-picker",{directives:[{name:"show",rawName:"v-show",value:t.isUsingFillColor,expression:"isUsingFillColor"}],staticClass:"fillpicker",model:{value:t.objectStyle.fill,callback:function(e){t.$set(t.objectStyle,"fill",e)},expression:"objectStyle.fill"}}),t._v(" "),n("color-picker",{directives:[{name:"show",rawName:"v-show",value:t.isUsingStrokeColor,expression:"isUsingStrokeColor"}],staticClass:"strokepicker",model:{value:t.objectStyle.stroke,callback:function(e){t.$set(t.objectStyle,"stroke",e)},expression:"objectStyle.stroke"}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},"Wt/O":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var o=n("Zrlr"),s=n.n(o),i=n("wxAW"),r=n.n(i),a=function(){function t(e){s()(this,t),this.id=e,this.zIndex=0,this.geometry={positionX:0,positionY:0,width:100,height:100}}return r()(t,[{key:"updateID",value:function(t){this.id=t}},{key:"updateGeometry",value:function(t,e,n,o){this.geometry.positionX=t,this.geometry.positionY=e,this.geometry.width=n,this.geometry.height=o}},{key:"updateZIndex",value:function(t){this.zIndex=t}},{key:"ID",get:function(){return this.id}},{key:"width",get:function(){return this.geometry.width}},{key:"height",get:function(){return this.geometry.height}},{key:"positionX",get:function(){return this.geometry.positionX}},{key:"positionY",get:function(){return this.geometry.positionY}},{key:"depth",get:function(){return this.zIndex}}]),t}()},X1HP:function(t,e){},X9oV:function(t,e,n){"use strict";function o(t){n("Ui19")}var s=n("3LUW"),i=n("pP5b"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},XW8H:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return"customshape"===t.object.type?n("customshape",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.style.strokeWidth,opacity:t.style.opacity}}):"storyline"===t.object.type?n("storyline",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.style.strokeWidth,opacity:t.style.opacity},on:{storylineSelect:t.handleStorylineStyle}}):"triangle"===t.object.type?n("triangleg",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.style.strokeWidth,opacity:t.style.opacity}}):"rectangle"===t.object.type?n("rectangleg",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.style.strokeWidth,opacity:t.style.opacity}}):"pentagon"===t.object.type?n("pentagong",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.style.strokeWidth,opacity:t.style.opacity}}):"hexagon"===t.object.type?n("hexagong",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.style.strokeWidth,opacity:t.style.opacity}}):"line"===t.object.type?n("lineg",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:3,opacity:t.style.opacity}}):"echelon"===t.object.type?n("echelong",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.style.strokeWidth,opacity:t.style.opacity}}):t._e()},s=[],i={render:o,staticRenderFns:s};e.a=i},YRYm:function(t,e,n){"use strict";function o(t){n("01qU")}var s=n("vqau"),i=n("d5AP"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},YfC9:function(t,e,n){"use strict";var o=n("5e6B"),s=n("GMF1"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},Yq7S:function(t,e,n){"use strict";function o(t){n("Z3Nt")}var s=n("pq9Y"),i=n("UiOb"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},YrUE:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("rWw5"),a=n("upPS"),u=n("vjNh");e.a={name:"ShapePanel",data:function(){return{shapeType:""}},computed:s()({fillColor:function(){return{background:this.objectStyle.fill.hex}},strokeColor:function(){return{background:this.objectStyle.stroke.hex}}},Object(i.c)(["isUsingFillColor","isUsingStrokeColor","isUsingPenTool","objectStyle","focusText"])),methods:{handleRectangle:function(){this.insertShape("rectangle"),this.$store.commit(u.l,"PenTool")},handleHexagon:function(){this.insertShape("hexagon"),this.$store.commit(u.l,"PenTool")},handlePentagon:function(){this.insertShape("pentagon"),this.$store.commit(u.l,"PenTool")},handleTriangle:function(){this.insertShape("triangle"),this.$store.commit(u.l,"PenTool")},handleEchelon:function(){this.insertShape("echelon"),this.$store.commit(u.l,"PenTool")},handleLine:function(){this.isUsingPenTool?this.$store.commit(u.l,"PenTool"):this.$store.commit(u.u,"PenTool")},insertShape:function(t){if(t){var e=new r.b(t);this.$store.commit(u.m,e)}},updateOpacity:function(t){this.objectStyle.opacity=t},updateStrokeWidth:function(t){this.objectStyle.strokeWidth=t},handleFillColor:function(){this.isUsingFillColor?this.$store.commit(u.h):this.$store.commit(u.q)},handleStrokeColor:function(){this.isUsingStrokeColor?this.$store.commit(u.j):this.$store.commit(u.s)}},watch:{isUsingPenTool:function(t){if(t){var e=new r.a("customshape");this.$store.commit(u.m,e)}}},components:{"visual-object":a.a}}},Z3Nt:function(t,e){},ZSvP:function(t,e,n){"use strict";var o=n("KmDb"),s=n.n(o);e.a={name:"BezierTool",props:["node","mouseX","mouseY","mousedownCount","mouseupCount"],data:function(){return{isBezierNodeDragged:!1,isSymmetryBezierNodeDragged:!1,xInNodeCoordinate:0,yInNodeCoordinate:0,fixedLength:0,fixedSymmetryLength:0,deltaX:0,deltaY:0}},methods:{handleMousedownForBezierNode:function(){this.isBezierNodeDragged=!0,this.xInNodeCoordinate=this.mouseX-this.node.x2,this.yInNodeCoordinate=this.mouseY-this.node.y2,this.deltaX=this.node.x2-this.node.x,this.deltaY=this.node.y2-this.node.y,this.fixedLength=s()(this.deltaX,this.deltaY);var t=this.node.x3-this.node.x,e=this.node.y3-this.node.y;this.fixedSymmetryLength=s()(t,e)},handleMousedownForSymmetryBezierNode:function(){this.isSymmetryBezierNodeDragged=!0,this.xInNodeCoordinate=this.mouseX-this.node.x3,this.yInNodeCoordinate=this.mouseY-this.node.y3,this.deltaX=this.node.x3-this.node.x,this.deltaY=this.node.y3-this.node.y,this.fixedSymmetryLength=s()(this.deltaX,this.deltaY);var t=this.node.x2-this.node.x,e=this.node.y2-this.node.y;this.fixedLength=s()(t,e)},moveBezierNodeX:function(t){this.node.x2=t,this.deltaX=this.node.x2-this.node.x;var e=s()(this.deltaX,this.deltaY),n=this.fixedSymmetryLength/e;this.node.x3=n*(this.node.x-t)+this.node.x},moveBezierNodeY:function(t){this.node.y2=t,this.deltaY=this.node.y2-this.node.y;var e=s()(this.deltaX,this.deltaY),n=this.fixedSymmetryLength/e;this.node.y3=n*(this.node.y-t)+this.node.y},moveSymmetryBezierNodeX:function(t){this.node.x3=t,this.deltaX=this.node.x3-this.node.x;var e=s()(this.deltaX,this.deltaY),n=this.fixedLength/e;this.node.x2=n*(this.node.x-t)+this.node.x},moveSymmetryBezierNodeY:function(t){this.node.y3=t,this.deltaY=this.node.y3-this.node.y;var e=s()(this.deltaX,this.deltaY),n=this.fixedLength/e;this.node.y2=n*(this.node.y-t)+this.node.y}},watch:{mouseupCount:function(){this.isBezierNodeDragged=!1,this.isSymmetryBezierNodeDragged=!1},mouseX:function(t){this.isBezierNodeDragged&&this.moveBezierNodeX(t),this.isSymmetryBezierNodeDragged&&this.moveSymmetryBezierNodeX(t)},mouseY:function(t){this.isBezierNodeDragged&&this.moveBezierNodeY(t),this.isSymmetryBezierNodeDragged&&this.moveSymmetryBezierNodeY(t)}}}},aYsG:function(t,e,n){"use strict";var o=n("1N/p");e.a={name:"Line",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],mounted:function(){this.object.isCreate||(this.object.addBezierNode(50,50,50,50),this.object.addBezierNode(150,150,150,150),this.object.init())},computed:{nodes:function(){return this.object.nodes},visible:function(){return this.object.isShow},reshape:function(){return this.object.isReshape},pathD:function(){var t="";return this.nodes.forEach(function(e,n){t+=0===n?"M "+e.x+" "+e.y:" L "+e.x+" "+e.y}),this.nodes.length>=2&&(t+=" L "+this.nodes[0].x+" "+this.nodes[0].y),t}},components:{controlnode:o.a}}},ayw7:function(t,e,n){"use strict";e.a={name:"ControlNode",props:["mouseX","mouseY","mousedownCount","mouseupCount","node"],data:function(){return{dragged:!1,squareSize:6,xInNodeCoordinate:0,yInNodeCoordinate:0}},methods:{handleMousedown:function(){0===event.button&&(this.dragged=!0),this.xInNodeCoordinate=this.mouseX-this.node.x,this.yInNodeCoordinate=this.mouseY-this.node.y},handleClick:function(){return this.node.isActiveBezierTool?this.node.closeBezierTool():this.node.activateBezierTool()},handleContextmenu:function(){return this.$emit("deleteNode"),!1}},watch:{mouseX:function(t){this.dragged&&(this.node.x=t-this.xInNodeCoordinate,this.node.x2&&(this.node.x2=this.node.x),this.node.x3&&(this.node.x3=this.node.x))},mouseY:function(t){this.dragged&&(this.node.y=t-this.yInNodeCoordinate,this.node.y2&&(this.node.y2=this.node.y),this.node.y3&&(this.node.y3=this.node.y))},mouseupCount:function(){this.dragged=!1}}}},cPX6:function(t,e){},crmn:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{on:{mouseup:function(e){return t.handleMouseup(e)},mousedown:function(e){return t.handleMousedown(e)}}},[n("styleframe",{attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount,mouseupCount:t.mouseupCount}}),t._v(" "),t.isScaleShow?n("rectframe",{attrs:{mouseX:t.mouseX,mouseY:t.mouseY,frameX:t.frameX,frameY:t.frameY,frameW:t.frameW,frameH:t.frameH},on:{updateX:function(e){return t.scaleByX(e)},updateY:function(e){return t.scaleByY(e)},updateW:function(e){return t.scaleByW(e)},updateH:function(e){return t.scaleByH(e)},updateFrame:function(e){return t.updateFrame(e)},rotate:function(e){return t.rotate(e)}}}):t._e()],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},cxcd:function(t,e,n){"use strict";var o=n("ZSvP"),s=n("5G65"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},d5AP:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"tool-box"}},[n("upload-tool"),t._v(" "),n("save-tool"),t._v(" "),t._l(t.toolItems,function(e,o){return n("tool-item",{key:o,attrs:{toolName:e,usingToolName:t.usingToolName},on:{enterTool:function(e){return t.enterTool(e)},calcelTool:function(e){return t.cancelTool(e)}}})}),t._v(" "),n("undo-tool")],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},dXrS:function(t,e,n){"use strict";function o(){return"fa-"+(a++).toString(16)}var s=n("bOdI"),i=n.n(s),r={};e.a={name:"fa-icon",props:{name:{type:String,validator:function(t){return!t||t in r||(console.warn('Invalid prop: prop "name" is referring to an unregistered icon "'+t+'".\nPlease make sure you have imported this icon before using it.'),!1)}},scale:[Number,String],spin:Boolean,inverse:Boolean,pulse:Boolean,flip:{validator:function(t){return"horizontal"===t||"vertical"===t}},label:String},data:function(){return{x:!1,y:!1,childrenWidth:0,childrenHeight:0,outerScale:1}},computed:{normalizedScale:function(){var t=this.scale;return t=void 0===t?1:Number(t),isNaN(t)||t<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.',this),this.outerScale):t*this.outerScale},klass:function(){return i()({"fa-icon":!0,"fa-spin":this.spin,"fa-flip-horizontal":"horizontal"===this.flip,"fa-flip-vertical":"vertical"===this.flip,"fa-inverse":this.inverse,"fa-pulse":this.pulse},this.$options.name,!0)},icon:function(){return this.name?r[this.name]:null},box:function(){return this.icon?"0 0 "+this.icon.width+" "+this.icon.height:"0 0 "+this.width+" "+this.height},ratio:function(){if(!this.icon)return 1;var t=this.icon,e=t.width,n=t.height;return Math.max(e,n)/16},width:function(){return this.childrenWidth||this.icon&&this.icon.width/this.ratio*this.normalizedScale||0},height:function(){return this.childrenHeight||this.icon&&this.icon.height/this.ratio*this.normalizedScale||0},style:function(){return 1!==this.normalizedScale&&{fontSize:this.normalizedScale+"em"}},raw:function(){if(!this.icon||!this.icon.raw)return null;var t=this.icon.raw,e={};return t=t.replace(/\s(?:xml:)?id=(["']?)([^"')\s]+)\1/g,function(t,n,s){var i=o();return e[s]=i,' id="'+i+'"'}),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,function(t,n,o,s){var i=n||s;return i&&e[i]?"#"+e[i]:t}),t}},mounted:function(){var t=this;if(!this.name&&0===this.$children.length)return void console.warn('Invalid prop: prop "name" is required.');if(!this.icon){var e=0,n=0;this.$children.forEach(function(o){o.outerScale=t.normalizedScale,e=Math.max(e,o.width),n=Math.max(n,o.height)}),this.childrenWidth=e,this.childrenHeight=n,this.$children.forEach(function(t){t.x=(e-t.width)/2,t.y=(n-t.height)/2})}},register:function(t){for(var e in t){var n=t[e];n.paths||(n.paths=[]),n.d&&n.paths.push({d:n.d}),n.polygons||(n.polygons=[]),n.points&&n.polygons.push({points:n.points}),r[e]=n}},icons:r};var a=870711},dZkg:function(t,e,n){"use strict";var o=n("U02f"),s=n("J4kB"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},eVrT:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"story-panel"}},[n("div",{staticClass:"slider-wrapper"},[t._v("\n    width\n    "),n("tool-slider",{attrs:{modelVal:t.canvasW,min:1e3,max:5e3,step:10},on:{updateSliderVal:function(e){return t.updateCanvasW(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    height\n    "),n("tool-slider",{attrs:{modelVal:t.canvasH,min:500,max:2e3,step:10},on:{updateSliderVal:function(e){return t.updateCanvasH(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    xScale\n    "),n("tool-slider",{attrs:{modelVal:t.storyConfig.xScaleFactor,min:0,max:1,step:.01},on:{updateSliderVal:function(e){return t.updateXScalingFactor(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    yScale\n    "),n("tool-slider",{attrs:{modelVal:t.storyConfig.yScaleFactor,min:.5,max:1,step:.02},on:{updateSliderVal:function(e){return t.updateYScalingFactor(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    Relax\n    "),n("tool-slider",{attrs:{modelVal:t.storyConfig.relaxingFactor,min:0,max:100,step:1},on:{updateSliderVal:function(e){return t.updateRelaxingFactor(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    Frame\n    "),n("tool-slider",{attrs:{modelVal:t.storyConfig.frameStep,min:50,max:500,step:1},on:{updateSliderVal:function(e){return t.updateFrameStep(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    Curve\n    "),n("tool-slider",{attrs:{modelVal:t.storyConfig.curveStep,min:50,max:500,step:1},on:{updateSliderVal:function(e){return t.updateCurveStep(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    Smooth\n    "),n("tool-slider",{attrs:{modelVal:t.storyConfig.sampleStep,min:2,max:20,step:1},on:{updateSliderVal:function(e){return t.updateSampleStep(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n    Sketch\n    "),n("tool-slider",{attrs:{modelVal:t.storyConfig.jitterWave,min:1,max:5,step:.2},on:{updateSliderVal:function(e){return t.updateJitterWave(e)}}})],1),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.storyConfig.content,expression:"storyConfig.content"}],attrs:{name:"storyConfig",cols:"30",rows:"10",placeholder:"story configuration here..."},domProps:{value:t.storyConfig.content},on:{input:function(e){e.target.composing||t.$set(t.storyConfig,"content",e.target.value)}}})])},s=[],i={render:o,staticRenderFns:s};e.a=i},ebHo:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("vjNh"),a=n("puZo"),u=n("DLEB"),c=n("iJRs"),l=n("L8V5"),h=n("lPMi"),d=n("knr3");n.n(d);e.a={name:"Storyline",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],data:function(){return{sampleNodes:[],targetPath:[],dragMoving:!1,dashlineRange:[],needAnimation:!0,storyReorder:null,sessionMover:null,recordY:0}},computed:s()({nodes:function(){return this.object.nodes},cleanNodes:function(){return this.nodes.filter(function(t){return t.y>0})},samples:function(){return this.sampleNodes},visible:function(){return this.object.isShow&&"RABBIT"!==this.object.name},character:function(){return this.object.name},starwarColor:function(){switch(this.character){case"VADER":return"black";case"R2-D2":return"blue";case"C-3PO":return"orange";case"CHEWIE":return"brown";case"JABBA":case"GREEDO":case"YODA":case"BOBA FETT":return"green";case"EMPEROR":return"black";case"T-REX":case"RAPTOR1":case"RAPTOR2":case"RAPTOR3":case"DILOPHOSAURUS":return"red";case"SMITH":return"black";case"TRINITY":return"red";case"NEO":return"blue";case"MORPHEUS":return"purple";case"TANK":return"green";default:return"gray"}},labelX:function(){return this.sampleNodes.length>0&&this.nodes.length>0?this.sampleNodes[0].x-5:-1e4},labelY:function(){return this.sampleNodes.length>0&&this.nodes.length>0?this.sampleNodes[0].y+5:-1e4},labelXEnd:function(){var t=this.sampleNodes.length-1;return t>-1&&this.nodes.length>0?this.sampleNodes[t].x+5:-1e4},labelYEnd:function(){var t=this.sampleNodes.length-1;return t>-1&&this.nodes.length>0?this.sampleNodes[t].y+5:-1e4},bone:function(){var t=this.removeInvalidNodes(this.object.nodes);this.sampleNodes=t;var e="";return t.forEach(function(t,n){var o=t.x,s=t.y;e+=0===n?"M "+o+" "+s:" L "+o+" "+s}),e},pathD:function(){var t=this.cleanNodes;if(t.length>0){var e=new u.a(t),n=e.fit(),o=this.sampleStep,s=l.a.sample(n,o),i=this.jitterWave;l.a.jitter(s,i),this.sampleNodes=s;var r=this.sampleStep;return this.calculatePathD(r,s)}return""},sampleStep:function(){return this.storyConfig.sampleStep},jitterWave:function(){return this.storyConfig.jitterWave}},Object(i.c)(["isUsingOrderTool","isUsingBendTool","isUsingCurveTool","isUsingLinkTool","dashRangeMap","storyConfig","storyFrameMap","storySessionMap","storyCharacterMap","storylines","selectedCharacters"])),methods:{handleMousedown:function(){this.isUsingOrderTool&&(this.storyReorder=new a.d(this.storylines,this.storyConfig,this.storyFrameMap,this.storySessionMap,this.storyCharacterMap),this.storyReorder.locate(this.mouseX,this.mouseY),this.recordY=this.mouseY),this.isUsingCurveTool&&0===this.selectedCharacters.length&&(this.sessionMover=new a.c(this.storylines,this.storyFrameMap,this.storySessionMap,this.storyCharacterMap),this.sessionMover.locate(this.mouseX,this.mouseY),this.recordY=this.mouseY)},handleMouseup:function(){if(this.isUsingOrderTool&&this.storyReorder){var t=this.storyReorder.reorder();t.frame>-1&&this.$store.dispatch("orderSession",t),this.storyReorder=null}this.isUsingCurveTool&&0===this.selectedCharacters.length&&(this.sessionMover=null)},handleSelecting:function(){(this.isUsingCurveTool||this.isUsingLinkTool)&&this.$store.commit(r.d,this.object.characterId),this.isUsingBendTool&&this.$store.commit(r.b,this.object.characterId),this.$emit("storylineSelect")},beginDragMoving:function(){this.dragMoving=!0,this.recordY=this.mouseY},endDragMoving:function(){this.dragMoving=!1,this.recordY=0,this.isUsingOrderTool&&this.$store.dispatch("orderStoryline",this.object.characterId)},removeInvalidNodes:function(t){for(var e=[],n=0,o=t.length;n<o;n++)0===n?t[n].y>-1e4&&e.push(t[n]):n===o-1?t[n].y>-1e4&&e.push(t[n]):t[n].y>-1e4&&(Math.abs(t[n].y-t[n-1].y)>1||Math.abs(t[n].y-t[n+1].y)>1)&&e.push(t[n]);return e},appendDashline:function(t,e,n){var o="",s=this.sampleNodes;if(0===e)o+="M "+t.x+" "+t.y;else{for(var i=n/2,r=t.y,a=s[e-1].y,u=t.x,c=s[e-1].x,l=Math.atan2(r-a,u-c),h=Math.sin(l)*i,d=Math.cos(l)*i,f=c,m=!1;d>0&&f+d<u||d<0&&f+d>u;)o+=m?" l":" m",o+=" "+d+" "+h,m=!m,f+=d;o+=" L "+u+" "+r}return o},appendCurve:function(t,e){var n=this.sampleNodes,o="";if(t<2)for(var s=1;s<2;s++)o+=" L "+n[t].x+" "+n[t].y;else e?this.jitterWave>0?o+=" C "+n[t-2].x+","+n[t-2].y+" "+n[t-1].x+","+n[t-1].y+" "+n[t].x+","+n[t].y:o+=" L "+n[t].x+" "+n[t].y:this.jitterWave>0?o+=" S "+n[t-1].x+","+n[t-1].y+" "+n[t].x+","+n[t].y:o+=" L "+n[t].x+" "+n[t].y;return o},calculatePathD:function(t,e){for(var n="",o=0,s=!1;o<e.length-3;){for(var i=e[o],r=!1,a=0;a<this.dashlineRange.length;a++)if(this.dashlineRange[a][0]<i.x&&i.x<this.dashlineRange[a][1]){r=!0;break}0===o?(n+=" M "+e[o].x+" "+e[o].y,o++):r?(n+=this.appendDashline(i,o,t),s=!0,o++):(s&&(o+=3),n+=this.appendCurve(o,s),o+=2,s=!1)}for(o-=3,o<0&&(o=0);o<e.length;o++)e[o]&&(n+=" L "+e[o].x+" "+e[o].y);return n},addDashlineRange:function(){switch(this.character){case"阿斯兰":return[[100,1e4]];case"斯特里克兰夫人":return[[380,1e4]];case"斯特里克兰":return[[0,300],[350,400]];case"我":return[[700,1800]];case"IMELDA":return[[250,1e4]];case"HECTOR":return[[230,1e4]];case"CRUZ":return[[250,1e4]];case"COCO":return[[1e3,1e4]];case"MIGUEL":return[[400,830]];default:return[]}}},mounted:function(){var t=this;this.object.init(),(new d).bind("esc",function(){t.isUsingCurveTool&&t.selectedCharacters.indexOf(t.object.characterId)>-1&&(new c.b(t.targetPath).moveFocusCharacter(t.object.nodes),t.targetPath=[])})},watch:{mouseY:function(t){if(this.dragMoving&&this.isUsingOrderTool&&t>0){var e=t-this.recordY;this.object.updateY(e)}if(this.isUsingOrderTool&&this.storyReorder){var n=this.mouseY-this.recordY;this.storyReorder.move(n)}if(this.isUsingCurveTool&&0===this.selectedCharacters.length&&this.sessionMover){var o=this.mouseY-this.recordY;this.sessionMover.move(o)}},mousedownCount:function(t){this.isUsingCurveTool&&this.selectedCharacters.indexOf(this.object.characterId)>-1&&this.targetPath.push({x:this.mouseX,y:this.mouseY})},mouseupCount:function(t){if(this.dragMoving&&this.isUsingOrderTool&&this.endDragMoving(),this.isUsingOrderTool&&this.storyReorder){var e=this.storyReorder.reorder();e.frame>-1&&this.$store.dispatch("orderSession",e),this.storyReorder=null}this.isUsingCurveTool&&0===this.selectedCharacters.length&&(this.sessionMover=null)},dashRangeMap:function(t){this.selectedCharacters.indexOf(this.object.characterId)>-1&&(this.dashlineRange=t)},nodes:function(t,e){var n=this;this.needAnimation&&e&&(t.length!==e.length&&console.error("mismatch"),e.forEach(function(o,s){(o.x!==t[s].x||o.y!==t[s].y)&&o.y>0&&h.a.fromTo(n.nodes[s],1,{x:e[s].x,y:e[s].y},{x:t[s].x,y:t[s].y})}))}}}},ecCa:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("MIrv"),a=n("gfC4"),u=n("58s9"),c=n("nNzv");e.a={name:"SidePanel",data:function(){return{styleObject:{left:"-260px"}}},computed:s()({},Object(i.c)(["panelActivated","panelName"])),watch:{panelActivated:function(t){this.styleObject.left=t?"80px":"-260px"}},components:{"tree-panel":r.a,"shape-panel":a.a,"story-panel":u.a,"text-panel":c.a}}},ewtb:function(t,e,n){"use strict";var o=n("syNJ"),s=n("zr+e"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},fOqo:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"custom-shape"},[n("path",{attrs:{d:t.pathD,fill:t.fillColor,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),t._l(t.nodes,function(e,o){return n("g",{key:o},[n("beziertool",{directives:[{name:"show",rawName:"v-show",value:e.isActiveBezierTool,expression:"node.isActiveBezierTool"}],attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,node:e}}),t._v(" "),n("controlnode",{directives:[{name:"show",rawName:"v-show",value:!t.created||t.reshape,expression:"!created || reshape"}],attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,index:o,node:e},on:{deleteNode:function(e){return t.deleteNode(o)}}})],1)})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},fb9g:function(t,e,n){"use strict";function o(t){n("ncPy")}var s=n("ebHo"),i=n("yq3R"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},flRY:function(t,e,n){"use strict";var o=n("1N/p");e.a={name:"Pentagon",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],mounted:function(){this.object.isCreate||(this.object.addBezierNode(90,10,90,10),this.object.addBezierNode(170,70,170,70),this.object.addBezierNode(140,165,140,165),this.object.addBezierNode(40,165,40,165),this.object.addBezierNode(10,70,10,70),this.object.init())},computed:{nodes:function(){return this.object.nodes},visible:function(){return this.object.isShow},reshape:function(){return this.object.isReshape},pathD:function(){var t="";return this.nodes.forEach(function(e,n){t+=0===n?"M "+e.x+" "+e.y:" L "+e.x+" "+e.y}),this.nodes.length>2&&(t+=" L "+this.nodes[0].x+" "+this.nodes[0].y),t}},components:{controlnode:o.a}}},g7oG:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO");e.a={name:"TextPanel",computed:s()({},Object(i.c)(["focusText"]))}},gHnp:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shape-panel"},[n("div",{staticClass:"style-card"},[n("div",{staticClass:"color-wrapper",on:{click:t.handleFillColor}},[t._v("\n      Fill\n      "),n("input",{style:t.fillColor,attrs:{type:"text",name:"fillColor",readonly:"readonly"}})]),t._v(" "),n("div",{staticClass:"color-wrapper",on:{click:t.handleStrokeColor}},[t._v("\n      Stroke\n      "),n("input",{style:t.strokeColor,attrs:{type:"text",name:"strokeColor",readonly:"readonly"}})]),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n      Width\n      "),n("tool-slider",{attrs:{modelVal:t.objectStyle.strokeWidth,min:0,max:10,step:.1},on:{updateSliderVal:function(e){return t.updateStrokeWidth(e)}}})],1),t._v(" "),n("div",{staticClass:"slider-wrapper"},[t._v("\n      Opacity\n      "),n("tool-slider",{attrs:{modelVal:t.objectStyle.opacity,min:0,max:1,step:.01},on:{updateSliderVal:function(e){return t.updateOpacity(e)}}})],1)]),t._v(" "),n("div",{staticClass:"shape-row"},[n("div",{staticClass:"shape-item",on:{click:t.handleRectangle}},[t._v("\n      Rectangle\n    ")]),t._v(" "),n("div",{staticClass:"shape-item",on:{click:t.handleTriangle}},[t._v("\n      Triangle\n    ")]),t._v(" "),n("div",{staticClass:"shape-item",on:{click:t.handlePentagon}},[t._v("\n      Pentagon\n    ")])]),t._v(" "),n("div",{staticClass:"shape-row"},[n("div",{staticClass:"shape-item",on:{click:t.handleHexagon}},[t._v("\n      Hexagon\n    ")]),t._v(" "),n("div",{staticClass:"shape-item",on:{click:t.handleEchelon}},[t._v("\n      Echelon\n    ")]),t._v(" "),n("div",{staticClass:"shape-item",on:{click:t.handleLine}},[t._v("\n      Custom\n    ")])])])},s=[],i={render:o,staticRenderFns:s};e.a=i},gW7Q:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{staticClass:"rect-frame"},[n("rect",{attrs:{fill:"none",x:t.updateX,y:t.updateY,width:t.updateW,height:t.updateH,stroke:"blue"}}),t._v(" "),t._l(t.nodes,function(e,o){return n("rect",{key:o,style:e.cursor,attrs:{x:e.x-3,y:e.y-3,width:6,height:6,fill:"white",stroke:"blue","stroke-width":"1"},on:{mousedown:function(e){return t.handleMousedown(o)},mouseup:t.handleMouseup}})}),t._v(" "),n("line",{attrs:{x1:t.positionX,y1:t.positionY,x2:t.rotateNode.x,y2:t.rotateNode.y,stroke:"blue","stroke-width":"1"}}),t._v(" "),n("circle",{attrs:{fill:"blue",cx:t.rotateNode.x,cy:t.rotateNode.y,r:3,stroke:"black","stroke-width":"1"},on:{mousedown:t.handleRotateMousedown,mouseup:t.handleRotateMouseup}}),t._v(" "),n("circle",{attrs:{fill:"blue",cx:t.positionX,cy:t.positionY,r:3,stroke:"black","stroke-width":"1"},on:{mousedown:t.handleRotateMousedown,mouseup:t.handleRotateMouseup}})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},gfC4:function(t,e,n){"use strict";function o(t){n("2htf")}var s=n("YrUE"),i=n("gHnp"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},grRP:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box-card",style:t.position},t._l(t.states,function(e,o){return n("div",{key:o,staticClass:"state",on:{click:function(n){return t.handleClick(e)}}},[t._v("\n    "+t._s(e)+"\n  ")])}),0)},s=[],i={render:o,staticRenderFns:s};e.a=i},gsLH:function(t,e,n){"use strict";var o=n("AeaF"),s=n("EVPn"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},gxps:function(t,e,n){"use strict";var o=n("vjNh"),s=n("ieIR"),i=n("fb9g"),r=n("0d6M"),a=n("q+vf"),u=n("O1zv"),c=n("4IQm"),l=n("sfWC"),h=n("meyI");e.a={name:"StyleFrame",props:["mouseX","mouseY","mousedownCount","mouseupCount","object"],data:function(){return{isStorylineSelected:!1,style:{fill:{rgba:{r:255,g:255,b:255,a:1}},stroke:{rgba:{r:0,g:0,b:0,a:1}},strokeWidth:3,opacity:1}}},methods:{handleStorylineStyle:function(){this.isStorylineSelected=!this.isStorylineSelected,this.isStorylineSelected?this.$store.commit(o.o,this.style):this.$store.commit(o.y)}},computed:{fillColor:function(){return"rgba("+this.style.fill.rgba.r+","+this.style.fill.rgba.g+","+this.style.fill.rgba.b+","+this.style.fill.rgba.a+")"},selected:function(){return this.object.isSelected},strokeColor:function(){return this.selected?"rgba(0,0,255,1)":"rgba("+this.style.stroke.rgba.r+","+this.style.stroke.rgba.g+","+this.style.stroke.rgba.b+","+this.style.stroke.rgba.a+")"},strokeWidth:function(){return this.selected?1:this.style.strokeWidth},isScale:function(){return this.object.isScale}},watch:{isScale:function(t){t?this.$store.commit(o.o,this.style):this.$store.commit(o.y)}},components:{customshape:s.a,storyline:i.a,triangleg:r.a,rectangleg:a.a,pentagong:u.a,hexagong:c.a,lineg:l.a,echelong:h.a}}},hSCs:function(t,e,n){"use strict";var o,s=n("bOdI"),i=n.n(s),r=n("vjNh"),a={focusText:{},textObjects:[]},u={focusText:function(t){return t.focusText},textObjects:function(t){return t.textObjects}},c=(o={},i()(o,r.p,function(t,e){t.focusText=e}),i()(o,r.z,function(t){t.focusText={}}),o),l={insertTextObject:function(t,e){t.state.textObjects.push(e)}};e.a={state:a,getters:u,mutations:c,actions:l}},hnEm:function(t,e,n){"use strict";var o=n("sl5J"),s=n("5H7z"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},hxIt:function(t,e,n){"use strict";function o(t){n("X1HP")}var s=n("Mcgq"),i=n("grRP"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},i0bz:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;return(t._self._c||e)("move-frame",{style:t.cursorStyle,attrs:{object:t.object,mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount}})},s=[],i={render:o,staticRenderFns:s};e.a=i},iJRs:function(t,e,n){"use strict";n.d(e,"a",function(){return x}),n.d(e,"b",function(){return w});var o=n("yEsh"),s=n.n(o),i=n("Zx67"),r=n.n(i),a=n("zwoO"),u=n.n(a),c=n("Pf15"),l=n.n(c),h=n("ifoU"),d=n.n(h),f=n("d7EF"),m=n.n(f),p=n("Zrlr"),v=n.n(p),y=n("wxAW"),g=n.n(y),b=n("z4iF"),C=n("gkiq"),x=(n.n(C),function(){function t(e,n,o,s,i,r){v()(this,t),this.storylines=e,this.minFrame=n,this.maxFrame=o,this.config=s,this.sessionTable=r,this.targetPath=i}g()(t,[{key:"moveFocusCharacter",value:function(t){this.resetOptimization();for(var e=this.storylines[t].points,n=new k(this.targetPath),o=n.match(e,this.minFrame,this.maxFrame,this.config),s=m()(o,2),i=s[0],r=s[1],a=this.setOptimizingCharacters(t,i,r),u=i,c=r+1;u<c;u++){var l=a.get(u),h=n.fitCurve(e[u]);if(h>-1e4){h=this.alignContextPoint(u,h,e);var d=h-e[u].y;this.moveContextCharacters(u,l,t,d),e[u].y=h}}}},{key:"resetOptimization",value:function(){this.storylines.forEach(function(t){t.points.forEach(function(t){t.isOptimizedTmp=!1})})}},{key:"setOptimizingCharacters",value:function(t,e,n){for(var o=new d.a,s=e,i=n+1;s<i;s++){var r=this.scanInSessionCharacters(s,t);o.set(s,r)}return o}},{key:"scanInSessionCharacters",value:function(t,e){var n=[],o=this.generateFrame(t),s=this.sessionTable[e][o];if(s>-1){for(var i=0,r=this.sessionTable.length;i<r;i++)this.sessionTable[i][o]===s&&(n.push({id:i,y:this.storylines[i].points[t].y}),this.storylines[i].points[t].isOptimized=!0,this.storylines[i].points[t].isOptimizedTmp=!0);n.sort(function(t,e){return t.y-e.y})}return n.map(function(t){return t.id})}},{key:"generateFrame",value:function(t){return parseInt(t/2)}},{key:"moveContextCharacters",value:function(t,e,n,o){var s=this,i=[],r=[],a=!0;e.forEach(function(t){t===n&&(a=!1),a?i.push(t):r.push(t)}),i.push(n),i=i.reverse();var u=o;i.forEach(function(e){if(e!==n){var o=s.storylines[e].points,i=o[t].y;if(i>-1e4){var r=i+u;o[t].y=s.alignContextPoint(t,r,o),o[t].isOptimized=!0,u=o[t].y-i}}}),u=o,r.forEach(function(e){if(e!==n){var o=s.storylines[e].points,i=o[t].y;if(i>-1e4){var r=i+u;o[t].y=s.alignContextPoint(t,r,o),o[t].isOptimized=!0,u=o[t].y-i}}})}},{key:"alignContextPoint",value:function(t,e,n){var o=n.length,s=!1,i=!1,r=0,a=0,u=n[t].y;if(t>1){var c=n[t-1];c.isOptimizedTmp||(r=c.y)>-1e4&&Math.abs(u-r)<5&&(s=!0)}if(t<o-1){var l=n[t+1];l.isOptimizedTmp||(a=l.y)>-1e4&&Math.abs(u-a)<5&&(i=!0)}var h=e,d=1;return s&&(h+=4*r,d+=4),i&&(h+=4*a,d+=4),h/d}}])}(),function(){function t(e,n,o,s,i){v()(this,t),this.storylines=e,this.sessionTable=n,this.frameTable=o,this.config=s,this.targetPath=i}return g()(t,[{key:"moveFocusCharacter",value:function(t){var e=this.storylines[t].points,n=new k(this.targetPath),o=n.matchStoryline(e,this.config),s=m()(o,2),i=s[0],r=s[1];if(i>-1&&r>-1)for(var a=i,u=r+1;a<u;a++){var c=n.fitCurve(e[a]);c>-1e4&&(e[a].y=c)}}},{key:"reshapeCharacters",value:function(t){var e=this;t.forEach(function(t){e.moveFocusCharacter(t)})}}]),t}()),w=function(){function t(e){v()(this,t),this.targetPaths=[e]}return g()(t,[{key:"moveFocusCharacter",value:function(t){var e=this;this.targetPaths.forEach(function(n){if(n.length>0){var o=new k(n),s=o.matchStoryline(t,e.config),i=m()(s,2),r=i[0],a=i[1];if(r>-1&&a>-1)for(var u=r,c=a+1;u<c;u++){var l=o.fitCurve(t[u]);if(l>-1e4){t[u].y;t[u].y=l}}}})}}]),t}(),_=function(){function t(e){v()(this,t),this.targetPath=e,this.fittedCurve=[]}return g()(t,[{key:"syncrize",value:function(t){var e=this;this.fittedCurve=[];this.targetPath.forEach(function(t){var n=(t.x-0)/1,o=(t.y-0)/1,s=new b.c(n,o);e.fittedCurve.push(s)}),this.fittedCurve.sort(function(t,e){return t.x-e.x})}},{key:"matchStoryline",value:function(t,e){this.syncrize(e);var n=this.locate(t),o=m()(n,2),s=o[0],i=o[1];if(s>-1&&i>-1){var r=t[s],a=t[i],u=this.targetPath.length-1,c=new b.c(this.fittedCurve[0].x,this.fittedCurve[0].y),l=new b.c(this.fittedCurve[u].x,this.fittedCurve[u].y);if(i===t.length-1)this.fittedCurve.forEach(function(t){t.x=r.x+(t.x-c.x),t.y=r.y+(t.y-c.y)});else{var h=Math.abs((a.x-r.x)/(l.x-c.x)),d=Math.abs((a.y-r.y)/(l.y-c.y));this.fittedCurve.forEach(function(t){t.x=r.x+h*(t.x-c.x),t.y=r.y+d*(t.y-c.y)})}}return[s,i]}},{key:"locate",value:function(t){for(var e=this.targetPath.length-1,n=this.fittedCurve[0],o=this.fittedCurve[e],s=!1,i=!1,r=-1,a=t.length-1,u=1,c=t.length-1;u<c;u++)t[u].y>-1e4&&(!s&&t[u].x>n.x&&(r=t[u-1].y>-1e4?u-1:u,s=!0),!i&&t[u].x>o.x&&(a=u,i=!0));return[r,a]}},{key:"isFlatPoint",value:function(t,e){if(-1e4===t[e].y)return!1;if(0===e)return!0;for(var n=e-1;n>0&&-1e4===t[n--].y;);for(var o=e+1;o>0&&-1e4===t[o++].y;);return t[n+1].y===t[e].y||t[o-1].y===t[e].y}},{key:"match",value:function(t,e,n,o){this.syncrize(o);var s=this.getLeftPointIndex(t,e),i=t[s],r=this.getRightPointIndex(t,n),a=(t[r],new b.b(this.fittedCurve[0].x,this.fittedCurve[0].y)),u=this.fittedCurve.length-1;new b.b(this.fittedCurve[u].x,this.fittedCurve[u].y);return this.fittedCurve.forEach(function(t){t.x=i.x+(t.x-a.x),t.y=i.y+(t.y-a.y)}),[s,r]}},{key:"getLeftPointIndex",value:function(t,e){for(var n=2*e;-1e4===t[n++].y;);return n-1}},{key:"getRightPointIndex",value:function(t,e){for(var n=2*e+1;-1e4===t[n--].y;);return n+1}}]),t}(),k=(function(t){function e(t){return v()(this,e),u()(this,(e.__proto__||r()(e)).call(this,t))}l()(e,t),g()(e,[{key:"fitCurve",value:function(t){for(var e=0,n=this.fittedCurve.length-1;e<n;e++)if((t.x-this.fittedCurve[e].x)*(t.x-this.fittedCurve[e+1].x)<=0){var o=(this.fittedCurve[e+1].y-this.fittedCurve[e].y)/(this.fittedCurve[e+1].x-this.fittedCurve[e].x),s=this.fittedCurve[e].y+o*(t.x-this.fittedCurve[e].x);return-1e4===t.y?-1e4:(s+0*t.y)/1}return t.y}}])}(_),function(t){function e(t){return v()(this,e),u()(this,(e.__proto__||r()(e)).call(this,t))}return l()(e,t),g()(e,[{key:"match",value:function(t,n,o,i){var a=s()(e.prototype.__proto__||r()(e.prototype),"match",this).call(this,t,n,o,i),u=(this.fittedCurve,[]);this.fittedCurve.forEach(function(t){u.push(t.x),u.push(t.y)});var c=Object(C.getCurvePoints)(u,.5,2);this.fittedCurve=[];for(var l=0,h=c.length/2;l<h;l++){var d=c[2*l],f=c[2*l+1],m=new b.b(d,f);this.fittedCurve.push(m)}return a}},{key:"matchStoryline",value:function(t,n){var o=s()(e.prototype.__proto__||r()(e.prototype),"matchStoryline",this).call(this,t,n),i=(this.fittedCurve,[]);this.fittedCurve.forEach(function(t){i.push(t.x),i.push(t.y)});var a=Object(C.getCurvePoints)(i,.5,2);this.fittedCurve=[];for(var u=0,c=a.length/2;u<c;u++){var l=a[2*u],h=a[2*u+1],d=new b.c(l,h);this.fittedCurve.push(d)}return o}},{key:"fitCurve",value:function(t){for(var e=0,n=this.fittedCurve.length-1;e<n;e++)if((t.x-this.fittedCurve[e].x)*(t.x-this.fittedCurve[e+1].x)<=0){var o=(this.fittedCurve[e+1].y-this.fittedCurve[e].y)/(this.fittedCurve[e+1].x-this.fittedCurve[e].x),s=this.fittedCurve[e].y+o*(t.x-this.fittedCurve[e].x);if(-1e4===t.y)return-1e4;if(-5e3===t.y)return s;if(t.y>0)return(s+0*t.y)/1}return t.y}}]),e}(_))},ieIR:function(t,e,n){"use strict";var o=n("vDLA"),s=n("fOqo"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},ihPm:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"svg-card",style:t.styleObject,on:{mousedown:t.handleMousedown}},[n("svg",{staticClass:"svg-content"},[t._l(t.objects,function(e,o){return"text"!==e.type?n("visual-object",{key:o,attrs:{object:e,mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount}}):t._e()}),t._v(" "),n("frame-select",{attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount}}),t._v(" "),n("scale-select",{attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount}}),t._v(" "),n("path-select",{attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mousedownCount:t.mousedownCount}})],2),t._v(" "),t._l(t.textObjects,function(e,o){return n("text-object",{key:o,attrs:{mouse:t.mouse,object:e,scrollX:t.scrollX,scrollY:t.scrollY}})})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},ikkP:function(t,e,n){"use strict";var o=n("wEMg"),s=n("Ef3N"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},ip5d:function(t,e,n){"use strict";var o=n("vjNh");e.a={name:"UndoTool",methods:{handleClick:function(){console.log("undo-tool"),this.$store.dispatch(o.A),this.$store.dispatch("cancelReshape")}}}},j73T:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("knr3");n.n(r);e.a={name:"GroupSelect",props:{mouseX:Number,mouseY:Number,mousedownCount:Number,mouseupCount:Number},data:function(){return{sPoints:[],ePoints:[],linesNum:0,mousedownNum:0}},computed:s()({isUsingFrameSelect:function(){return this.isUsingBendTool||this.isUsingLinkTool}},Object(i.c)(["isUsingBendTool","isUsingLinkTool"])),methods:{restore:function(){this.sPoints=[],this.ePoints=[],this.linesNum=0,this.mousedownNum=0}},watch:{mousedownCount:function(t){this.mousedownNum++,this.mousedownNum%2==1&&this.sPoints.push({x:this.mouseX,y:this.mouseY}),this.mousedownNum%2==0&&(this.linesNum++,this.ePoints.push({x:this.mouseX,y:this.mouseY}))},isUsingBendTool:function(t){t?this.restore():this.$store.dispatch("straightenCharacter",{sPoints:this.sPoints,ePoints:this.ePoints,linesNum:this.linesNum})},isUsingSessionBreak:function(t){t?this.restore():this.$store.dispatch("breakSession",{sPoints:this.sPoints,ePoints:this.ePoints,linesNum:this.linesNum})},isUsingLinkTool:function(t){t?this.restore():this.$store.dispatch("brushingCharacter",{sPoints:this.sPoints,ePoints:this.ePoints,linesNum:this.linesNum})}},mounted:function(){var t=this;(new r).bind("esc",function(){t.isUsingBendTool&&t.$store.dispatch("straightenCharacter",{sPoints:t.sPoints,ePoints:t.ePoints,linesNum:t.linesNum}),t.isUsingLinkTool&&t.$store.dispatch("brushingCharacter",{sPoints:t.sPoints,ePoints:t.ePoints,linesNum:t.linesNum}),t.restore()})}}},kcJT:function(t,e){},l1bS:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"rectangle"},[n("path",{attrs:{d:t.pathD,fill:t.fillColor,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),t._l(t.nodes,function(e,o){return n("controlnode",{directives:[{name:"show",rawName:"v-show",value:t.reshape,expression:"reshape"}],key:o,attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,node:e}})})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},meyI:function(t,e,n){"use strict";var o=n("Kj9C"),s=n("3jbm"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},nNI8:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"side-panel",style:t.styleObject},[n("div",{staticClass:"side-panel-header"},[t._v(t._s("ShapePanel"===t.panelName?"ShapePanel":t.panelName))]),t._v(" "),"ElementPanel"===t.panelName?n("div",{staticClass:"side-panel-content"},[n("tree-panel")],1):t._e(),t._v(" "),"ShapePanel"===t.panelName?n("div",{staticClass:"side-panel-content"},[n("shape-panel")],1):t._e(),t._v(" "),"StoryPanel"===t.panelName?n("div",{staticClass:"side-panel-content"},[n("story-panel")],1):t._e(),t._v(" "),"TextPanel"===t.panelName?n("div",{staticClass:"side-panel-content"},[n("text-panel")],1):t._e()])},s=[],i={render:o,staticRenderFns:s};e.a=i},nNzv:function(t,e,n){"use strict";function o(t){n("cPX6")}var s=n("g7oG"),i=n("PCxI"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},nbaU:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"triangle"},[n("path",{attrs:{d:t.pathD,fill:t.fillColor,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),t._l(t.nodes,function(e,o){return n("controlnode",{directives:[{name:"show",rawName:"v-show",value:t.reshape,expression:"reshape"}],key:o,attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,node:e}})})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},ncPy:function(t,e){},pP5b:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"text-card",style:t.styleObject,on:{contextmenu:t.handleContextMenu,click:function(e){return e.stopPropagation(),t.handleClick(e)},mousedown:function(e){return e.stopPropagation(),t.handleMousedown(e)},mouseup:t.handleMouseup}},[t._v("\n  "+t._s(t.content)+"\n")])},s=[],i={render:o,staticRenderFns:s};e.a=i},peX0:function(t,e,n){"use strict";var o=n("gxps"),s=n("XW8H"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},pq9Y:function(t,e,n){"use strict";var o=n("mvHQ"),s=n.n(o),i=n("Dd8w"),r=n.n(i),a=n("NYxO");e.a={name:"UploadTool",computed:r()({},Object(a.c)(["request","history","storylines"])),methods:{handleClick:function(t){this.handleSaveSvg(t)},handleSaveSvg:function(t){var e=document.getElementsByClassName("svg-content")[0];e.setAttribute("xmlns","http://www.w3.org/2000/svg");var n=e.outerHTML,o=new Blob(['<?xml version="1.0" standalone="no"?>\r\n',n],{type:"image/svg+xml;charset=utf-8"}),s=URL.createObjectURL(o),i=document.createElement("a");i.href=s,i.download="storyline.svg",document.body.appendChild(i),i.click(),document.body.removeChild(i)},handleSaveConfig:function(){var t=this.request,e=s()(t),n="data:application/json;charset=utf-8,"+encodeURIComponent(e),o=document.createElement("a");o.href=n,o.download="config.json",document.body.appendChild(o),o.click(),document.body.removeChild(o)},handleSaveHistory:function(){var t={storylines:this.storylines},e=s()(t),n="data:application/json;charset=utf-8,"+encodeURIComponent(e),o=document.createElement("a");o.href=n,o.download="history.json",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}}},puZo:function(t,e,n){"use strict";n.d(e,"e",function(){return C}),n.d(e,"a",function(){return x}),n.d(e,"d",function(){return w}),n.d(e,"b",function(){return _}),n.d(e,"c",function(){return k});var o=n("ifoU"),s=n.n(o),i=n("Zx67"),r=n.n(i),a=n("zwoO"),u=n.n(a),c=n("Pf15"),l=n.n(c),h=n("BO1k"),d=n.n(h),f=n("d7EF"),m=n.n(f),p=n("Zrlr"),v=n.n(p),y=n("wxAW"),g=n.n(y),b=n("y8Pj"),C=function(){function t(e,n,o){v()(this,t),this.frameMap=e,this.sessionMap=n,this.characterMap=o}return g()(t,[{key:"matchFrame",value:function(t,e){var n=!0,o=!1,s=void 0;try{for(var i,r=d()(this.frameMap);!(n=(i=r.next()).done);n=!0){var a=i.value,u=m()(a,2),c=u[0],l=u[1];if((t-l[0])*(t-l[1])<=0)return c}}catch(t){o=!0,s=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw s}}return-1}},{key:"matchFrameUnBound",value:function(t,e){var n=1e4,o=0,s=!0,i=!1,r=void 0;try{for(var a,u=d()(this.frameMap);!(s=(a=u.next()).done);s=!0){var c=a.value,l=m()(c,2),h=l[0],f=l[1];if(n=f[0]<n?f[0]:n,o=h,(t-f[0])*(t-f[1])<=0)return h}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}return t<n?0:o}},{key:"matchCharacter",value:function(t,e){var n=this.matchFrame(t,e);if(n>-1){var o=this.characterMap.get(n),s=!0,i=!1,r=void 0;try{for(var a,u=d()(o);!(s=(a=u.next()).done);s=!0){var c=a.value,l=m()(c,2),h=l[0],f=l[1];if(Math.abs(e-f)<2)return h}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}}return-1}},{key:"matchCharacterR",value:function(t,e){if(t>-1){var n=this.characterMap.get(t),o=!0,s=!1,i=void 0;try{for(var r,a=d()(n);!(o=(r=a.next()).done);o=!0){var u=r.value,c=m()(u,2),l=c[0],h=c[1];if(Math.abs(e-h)<10)return l}}catch(t){s=!0,i=t}finally{try{!o&&a.return&&a.return()}finally{if(s)throw i}}}return-1}},{key:"matchSession",value:function(t,e){var n=this.matchFrame(t,e);if(!(n>-1))return-1;var o=this.characterMap.get(n),s=!0,i=!1,r=void 0;try{for(var a,u=d()(o);!(s=(a=u.next()).done);s=!0){var c=a.value,l=m()(c,2),h=l[0],f=l[1];if(Math.abs(e-f)<2)return this.sessionMap[h][n]}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}}}]),t}(),x=function(t){function e(t,n,o,s,i,a){v()(this,e);var c=u()(this,(e.__proto__||r()(e)).call(this,n,o,s));return c.rawStorylines=t,c.defaultInnerGap=i.sessionInnerGap,c.defaultOuterGap=i.sessionOuterGap,c.yScaleFactor=a.yScaleFactor,c.yBaseline=a.paddingTop,c}return l()(e,t),g()(e,[{key:"getSelectSessionList",value:function(t,e){for(var n=t[0].x<e[0].x?t[0].x:e[0].x,o=t[0].x<e[0].x?t[0].x:e[0].x,s=this.matchFrameUnBound(n,0),i=this.matchFrameUnBound(o,0),r=t[0].y<e[0].y?t[0].y:e[0].y,a=t[0].y>e[0].y?t[0].y:e[0].y,u=[],c=s;c<i+1;c++)for(var l=0,h=this.rawStorylines.length;l<h;l++){var d=this.rawStorylines[l].character_id,f=this.rawStorylines[l].points[c].item3*this.yScaleFactor+this.yBaseline;if(f>=r&&f<=a){var m=this.sessionMap[d][c];m>-1&&-1===u.indexOf(m)&&u.push(m)}}return u}},{key:"getScaleFactor",value:function(t,e){return Math.abs((e[1].y-t[1].y)/(e[0].y-t[0].y))}},{key:"buildSessionConstraints",value:function(t,e){var n=this.getSelectSessionList(t,e),o=this.getScaleFactor(t,e),s=this.defaultInnerGap*o,i=Math.abs(e[1].y-t[1].y),r=[];n.forEach(function(t){r.push({item1:t,item2:s})});for(var a=[],u=0,c=n.length;u<c;u++)for(var l=u+1;l<c;l++)a.push({item1:{item1:n[u],item2:n[l]},item2:{item1:i,item2:-1}});return{sessionInnerGaps:r,sessionOuterGaps:a}}}]),e}(C),w=function(t){function e(t,n,o,s,i){v()(this,e);var a=u()(this,(e.__proto__||r()(e)).call(this,o,s,i));return a.storylines=t,a.storyConfig=n,a.frame=-1,a.character=-1,a.session=-1,a.yBak1=0,a.yBak2=0,a.newY=0,a}return l()(e,t),g()(e,[{key:"locate",value:function(t,e){if(this.frame=this.matchFrame(t,e),this.frame>-1&&(this.character=this.matchCharacterR(this.frame,e),this.character>-1)){var n=this.storylines[this.character].points;this.yBak1=this.getPositionY(n,0),this.yBak2=this.getPositionY(n,1)}}},{key:"getPositionY",value:function(t,e){var n=this.frame;if(n>-1){var o=0,s=1;switch(n>0&&(o=2*n,s=o+1),e){case 0:return t[o].y>-1e4?t[o].y:t[s].y;case 1:return t[s].y}}return-1e4}},{key:"move",value:function(t){var e=this.storyConfig.yScaleFactor,n=this.storyConfig.paddingTop,o=t/e;if(this.character>-1&&this.frame>-1){var s=this.storylines[this.character].points;this.moveStoryline(s,o),this.newY=((this.yBak1+this.yBak2)/2+o)*e+n}}},{key:"moveStoryline",value:function(t,e){var n=this.frame;if(n>-1){var o=0,s=1;n>0&&(o=2*n,s=o+1),t[o].y=t[o].y>-1e4?this.yBak1+e:t[o].y,t[s].y=this.yBak2+e}}},{key:"reorder",value:function(){if(this.frame>-1){var t=this.reorderCharacter(),e=this.generateSessionOrder(t.order),n=this.reorderSession(),o=this.generateSessionOrder(n.order);return this.isArrayEqual(e,o)?t:n}}},{key:"isArrayEqual",value:function(t,e){if(t.length===e.length){for(var n=0,o=t.length;n<o;n++)if(t[n]!==e[n])return!1;return!0}return!1}},{key:"generateSessionOrder",value:function(t){var e=this,n=new s.a;t.forEach(function(t,o){if(t>-1){var s=e.sessionMap[o][e.frame];s>-1&&(n.has(s)?n.get(s)>t&&n.set(s,t):n.set(s,t))}});var o=[],i=!0,r=!1,a=void 0;try{for(var u,c=d()(n);!(i=(u=c.next()).done);i=!0){var l=u.value,h=m()(l,2),f=h[0],p=h[1];o.push({session:f,pos:p})}}catch(t){r=!0,a=t}finally{try{!i&&c.return&&c.return()}finally{if(r)throw a}}return o.sort(function(t,e){return t.pos-e.pos}),o.map(function(t){return t.session})}},{key:"reorderCharacter",value:function(){var t=this,e=[];return this.character>-1&&function(){for(var n=t.sessionMap.length,o=new s.a,i=0;i<n;i++){var r=t.sessionMap[i][t.frame];if(t.character===i&&(t.session=r),r>-1)if(o.has(r)){var a=o.get(r);a.push(i)}else o.set(r,[i])}var u=t.characterMap.get(t.frame),c=new s.a,l=!0,h=!1,f=void 0;try{for(var p,v=d()(o);!(l=(p=v.next()).done);l=!0){var y=p.value,g=m()(y,2),b=g[0],C=g[1];!function(e,n){var s=[],i=0;n.forEach(function(e){for(var n=t.character===e?t.newY:u.get(e),o=!1,r=0;r<s.length;r++){var a=s[r];if(n<(t.character===a?t.newY:u.get(a))){s.splice(r,0,e),o=!0;break}}o||s.push(e),i+=u.get(e)}),i/=n.length,c.set(e,i),o.set(e,s)}(b,C)}}catch(t){h=!0,f=t}finally{try{!l&&v.return&&v.return()}finally{if(h)throw f}}var x=[],w=[],_=!0,k=!1,S=void 0;try{for(var T,j=d()(o);!(_=(T=j.next()).done);_=!0){for(var N=T.value,P=m()(N,2),b=P[0],C=P[1],Y=!1,O=0;O<x.length;O++){var X=x[O];if(c.get(b)<c.get(X)){x.splice(O,0,b),w.splice(O,0,C),Y=!0;break}}Y||(x.push(b),w.push(C))}}catch(t){k=!0,S=t}finally{try{!_&&j.return&&j.return()}finally{if(k)throw S}}var E=[];w.forEach(function(t){E=E.concat(t)});var M=t.sessionMap.length-1,U=[];E.forEach(function(t){t!==M&&U.push(t)}),U.splice(0,0,M),E=U;var F=new s.a;E.forEach(function(t,e){F.set(t,e)});for(var B=0;B<n;B++)F.has(B)?e.push(F.get(B)):e.push(-1)}(),{frame:this.frame,order:e}}},{key:"reorderSession",value:function(){var t=this,e=[];return this.character>-1&&function(){for(var n=t.sessionMap.length,o=new s.a,i=0;i<n;i++){var r=t.sessionMap[i][t.frame];if(t.character===i&&(t.session=r),r>-1)if(o.has(r)){var a=o.get(r);a.push(i)}else o.set(r,[i])}var u=t.characterMap.get(t.frame),c=new s.a,l=!0,h=!1,f=void 0;try{for(var p,v=d()(o);!(l=(p=v.next()).done);l=!0){var y=p.value,g=m()(y,2),b=g[0],C=g[1];!function(e,n){var s=[],i=0;n.forEach(function(t){for(var e=u.get(t),n=!1,o=0;o<s.length;o++){var r=s[o];if(e<u.get(r)){s.splice(o,0,t),n=!0;break}}n||s.push(t),i+=e}),i=t.session===e?t.newY:i/n.length,c.set(e,i),o.set(e,s)}(b,C)}}catch(t){h=!0,f=t}finally{try{!l&&v.return&&v.return()}finally{if(h)throw f}}var x=[],w=[],_=!0,k=!1,S=void 0;try{for(var T,j=d()(o);!(_=(T=j.next()).done);_=!0){for(var N=T.value,P=m()(N,2),b=P[0],C=P[1],Y=!1,O=0;O<x.length;O++){var X=x[O];if(c.get(b)<c.get(X)){x.splice(O,0,b),w.splice(O,0,C),Y=!0;break}}Y||(x.push(b),w.push(C))}}catch(t){k=!0,S=t}finally{try{!_&&j.return&&j.return()}finally{if(k)throw S}}var E=[];w.forEach(function(t){E=E.concat(t)});var M=t.sessionMap.length-1,U=[];E.forEach(function(t){t!==M&&U.push(t)}),U.splice(0,0,M),E=U;var F=new s.a;E.forEach(function(t,e){F.set(t,e)});for(var B=0;B<n;B++)F.has(B)?e.push(F.get(B)):e.push(-1)}(),{frame:this.frame,order:e}}}]),e}(C),_=(function(t){function e(t,n,o){return v()(this,e),u()(this,(e.__proto__||r()(e)).call(this,t,n,o))}l()(e,t),g()(e,[{key:"merge",value:function(t,e){var n=matchSession(t,e),o=void 0;return-1!==n&&(o={item1:n,item2:0}),o}}])}(C),function(t){function e(t,n,o,s){v()(this,e);var i=u()(this,(e.__proto__||r()(e)).call(this,t,n,o));return i.defaultInnerGap=s,i}l()(e,t),g()(e,[{key:"split",value:function(t,e){var n=matchSession(t,e),o=void 0;return-1!==n&&(o={item1:n,item2:this.defaultInnerGap}),o}}])}(C),function(t){function e(t,n,o,s,i){v()(this,e);var a=u()(this,(e.__proto__||r()(e)).call(this,t,n,o));return a.frameSteps=s,a.curveSteps=i,a}return l()(e,t),g()(e,[{key:"scale",value:function(t,e){var n=t[0].x,o=e[0].x,s=t[1].x,i=e[1].x,r=this.matchFrameUnBound(n,0),a=this.matchFrameUnBound(o,0),u=Math.abs(i-s)/Math.abs(o-n);o>n?(console.log("horizontal scale curve step"),this.scaleCurveStep(r,a,u)):o<n&&(console.log("horizontal scale frame step"),this.scaleFrameStep(r,a,u))}},{key:"scaleCurveStep",value:function(t,e,n){if(e-1>=t+1)for(var o=0;o<this.frameMap.size;o++)t+1<=o&&o<=e-1&&(this.curveSteps[o]*=n)}},{key:"scaleFrameStep",value:function(t,e,n){if(t-1>=e+1)for(var o=0;o<this.frameMap.size;o++)e+1<=o&&o<=t-1&&(this.frameSteps[o]*=n)}}]),e}(C)),k=function(t){function e(t,n,o,i){v()(this,e);var a=u()(this,(e.__proto__||r()(e)).call(this,n,o,i));return a.storylines=t,a.moveTable=new s.a,a.yBak1=new s.a,a.yBak2=new s.a,a}return l()(e,t),g()(e,[{key:"locate",value:function(t,e){if(this.frame=this.matchFrame(t,e),this.frame>-1&&(this.character=this.matchCharacterR(this.frame,e),this.character>-1)){var n=new b.a(this.sessionMap);this.moveTable=n.find(this.character,this.frame);var o=!0,s=!1,i=void 0;try{for(var r,a=d()(this.moveTable);!(o=(r=a.next()).done);o=!0){var u=r.value,c=m()(u,2),l=c[0],h=c[1],f=this.storylines[l].points,p=h[0],v=this.getPositionY(f,p,0),y=this.getPositionY(f,p,1);this.yBak1.set(l,v),this.yBak2.set(l,y)}}catch(t){s=!0,i=t}finally{try{!o&&a.return&&a.return()}finally{if(s)throw i}}}}},{key:"getPositionY",value:function(t,e,n){if(e>-1){var o=0,s=1;switch(e>0&&(o=2*e,s=o+1),n){case 0:return t[o].y>-1e4?t[o].y:t[s].y;case 1:return t[s].y}}return-1e4}},{key:"move",value:function(t){var e=this.frame,n=this.character,o=this.moveTable;if(e>-1&&n>-1){var s=!0,i=!1,r=void 0;try{for(var a,u=d()(o);!(s=(a=u.next()).done);s=!0){var c=a.value,l=m()(c,2),h=l[0],f=l[1];this.moveStoryline(t,h,f)}}catch(t){i=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw r}}}}},{key:"moveStoryline",value:function(t,e,n){var o=this,s=this.storylines[e].points;n.forEach(function(n){var i=2*n,r=i+1,a=o.yBak1.get(e),u=o.yBak2.get(e);s[i].y=s[i].y>-1e4?a+t:s[i].y,s[r].y=u+t;var c=(s[i].y+s[r].y)/2;o.characterMap.get(n).set(e,c)})}}]),e}(C)},"q+vf":function(t,e,n){"use strict";var o=n("IJeS"),s=n("l1bS"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},"qOY/":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("div",{staticClass:"tree-node-content",class:{bold:t.isFolder},on:{dblclick:t.changeVisible}},[t.visible?n("p",[t._v(t._s(t.model.name)+"\n      "),t.isFolder?n("span",{on:{click:t.toggle}},[t._v("["+t._s(t.open?"-":"+")+"]")]):t._e()]):n("s",[t._v(t._s(t.model.name)+"\n      "),t.isFolder?n("span",{on:{click:t.toggle}},[t._v("["+t._s(t.open?"-":"+")+"]")]):t._e()])]),t._v(" "),t.isFolder?n("ul",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}]},t._l(t.model.children,function(t,e){return n("tree-node",{key:e,staticClass:"tree-node",attrs:{model:t}})}),1):t._e()])},s=[],i={render:o,staticRenderFns:s};e.a=i},qTQm:function(t,e,n){"use strict";function o(t){n("veAT")}var s=n("+ICT"),i=n("WZ6U"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},rFRI:function(t,e){},rNQu:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.isUsingScaleTool,expression:"isUsingScaleTool"}],staticClass:"red-select"},t._l(t.linesNum,function(e){return n("line",{key:e,attrs:{x1:t.sPoints[e-1].x,y1:t.sPoints[e-1].y,x2:t.ePoints[e-1].x,y2:t.ePoints[e-1].y,stroke:"red","stroke-width":"3"}})}),0)},s=[],i={render:o,staticRenderFns:s};e.a=i},rWw5:function(t,e,n){"use strict";n.d(e,"b",function(){return y}),n.d(e,"a",function(){return g}),n.d(e,"c",function(){return b}),n.d(e,"d",function(){return C});var o=n("Zx67"),s=n.n(o),i=n("zwoO"),r=n.n(i),a=n("Pf15"),u=n.n(a),c=n("Zrlr"),l=n.n(c),h=n("wxAW"),d=n.n(h),f=n("z4iF"),m=function(){function t(){l()(this,t),this._visible=!0,this._scale=!1,this._reshape=!1,this._move=!0,this._select=!1,this._rotate=!1,this._create=!1}return d()(t,[{key:"activateShow",value:function(){this._visible=!0}},{key:"closeShow",value:function(){this._visible=!1}},{key:"activateScale",value:function(){this._scale=!0}},{key:"closeScale",value:function(){this._scale=!1}},{key:"activateReshape",value:function(){this._reshape=!0}},{key:"closeReshape",value:function(){this._reshape=!1}},{key:"activateMove",value:function(){this._move=!0}},{key:"closeMove",value:function(){this._move=!1}},{key:"activateSelect",value:function(){this._select=!0}},{key:"closeSelect",value:function(){this._select=!1}},{key:"activateRotate",value:function(){this._rotate=!0}},{key:"closeRotate",value:function(){this._rotate=!1}},{key:"initState",value:function(){this._create=!0,this._move=!0}},{key:"isShow",get:function(){return this._visible}},{key:"isScale",get:function(){return this._scale}},{key:"isReshape",get:function(){return this._reshape}},{key:"isMove",get:function(){return this._move}},{key:"isSelect",get:function(){return this._select}},{key:"isRotate",get:function(){return this._rotate}},{key:"isCreate",get:function(){return this._create}}]),t}(),p=function(t){function e(t){l()(this,e);var n=r()(this,(e.__proto__||s()(e)).call(this));return n._id=-1,n._type=t,n._name="",n._cardID=0,n}return u()(e,t),d()(e,[{key:"name",get:function(){return this._name},set:function(t){this._name=t}},{key:"type",get:function(){return this._type}},{key:"id",get:function(){return this._id},set:function(t){this._id=t}}]),e}(m),v=function(t){function e(t){l()(this,e);var n=r()(this,(e.__proto__||s()(e)).call(this,t));return n._frameX=0,n._frameY=0,n._frameW=0,n._frameH=0,n._positionX=0,n._positionY=0,n._offsetX=0,n._offsetY=0,n.geometry={nodes:[]},n}return u()(e,t),d()(e,[{key:"move",value:function(t,e){this._positionX+=t,this._positionY+=e,this._frameX+=t,this._frameY+=e,this.geometry.nodes.forEach(function(n){n.move(t,e)})}},{key:"rotate",value:function(t,e){var n=this;this.geometry.nodes.forEach(function(o){o.rotate(t,e,n._positionX,n._positionY)}),this.updateFrame()}},{key:"update",value:function(t,e){this.geometry.nodes.forEach(function(n){n.update(t,e)}),this.updateFrame(),this.updatePosition()}},{key:"updateX",value:function(t){this.geometry.nodes.forEach(function(e){e.y>-1e4&&e.updateX(t)}),this.updateFrame(),this.updatePosition()}},{key:"updateY",value:function(t){this.geometry.nodes.forEach(function(e){e.y>-1e4&&e.updateY(t)}),this.updateFrame(),this.updatePosition()}},{key:"updateFrame",value:function(){var t=this.geometry.nodes.map(function(t){return t.x}),e=this.geometry.nodes.map(function(t){return t.y});this._frameX=Math.min.apply(null,t),this._frameW=Math.max.apply(null,t)-this._frameX,this._frameY=Math.min.apply(null,e),this._frameH=Math.max.apply(null,e)-this._frameY}},{key:"updatePosition",value:function(){this._positionX=this._frameX+this._frameW/2,this._positionY=this._frameY+this._frameH/2}},{key:"scale",value:function(t){}},{key:"initTransform",value:function(){this.geometry.nodes.forEach(function(t){t.backup()})}},{key:"addBezierNode",value:function(t,e,n,o){var s=new f.a(t,e,n,o);return this.geometry.nodes.push(s),this.geometry.nodes.length-1}},{key:"updateBezierNode",value:function(t,e,n,o,s){var i=new f.a(e,n,o,s);this.geometry.nodes.length<t?this.geometry.nodes.push(i):this.geometry.nodes[t]=i}},{key:"deleteBezierNode",value:function(t){this.geometry.nodes.splice(t,1)}},{key:"init",value:function(){this.updateFrame(),this.updatePosition(),this.initState()}},{key:"frameX",get:function(){return this._frameX},set:function(t){this._frameX=t}},{key:"frameY",get:function(){return this._frameY},set:function(t){this._frameY=t}},{key:"frameH",get:function(){return this._frameH},set:function(t){this._frameH=t}},{key:"frameW",get:function(){return this._frameW},set:function(t){this._frameW=t}},{key:"positionX",get:function(){return this._positionX}},{key:"positionY",get:function(){return this._positionY}},{key:"nodes",get:function(){return this.geometry.nodes},set:function(t){this.geometry.nodes=t}}]),e}(p),y=function(t){function e(t){return l()(this,e),r()(this,(e.__proto__||s()(e)).call(this,t))}return u()(e,t),e}(v),g=function(t){function e(t){return l()(this,e),r()(this,(e.__proto__||s()(e)).call(this,t))}return u()(e,t),e}(v),b=function(t){function e(t){l()(this,e);var n=r()(this,(e.__proto__||s()(e)).call(this,t));return n._characterId=-1,n}return u()(e,t),d()(e,[{key:"init",value:function(){this.updateFrame(),this.updatePosition(),this.initState(),this.closeMove()}},{key:"characterId",get:function(){return this._characterId},set:function(t){this._characterId=t}}]),e}(v),C=(function(t){function e(t){return l()(this,e),r()(this,(e.__proto__||s()(e)).call(this,t))}u()(e,t)}(v),function(t){function e(t,n,o){l()(this,e);var i=r()(this,(e.__proto__||s()(e)).call(this,t));return i.frameX=n,i.frameY=o,i._frameX=n,i._frameY=o,i.frameW=0,i.frameH=0,i.fontSize=12,i.fontFamily="Arial",i.color="black",i.content="hello",i.initState(),i}return u()(e,t),d()(e,[{key:"updateX",value:function(t){this.frameX=this._frameX+t}},{key:"updateY",value:function(t){this.frameY=this._frameY+t}},{key:"beginMove",value:function(){this._frameX=this.frameX,this._frameY=this.frameY}}]),e}(p))},rkOb:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Bending",expression:"'Bending'"}]},[n("font-awesome-icon",{attrs:{icon:t.icon}})],1)},s=[],i={render:o,staticRenderFns:s};e.a=i},segE:function(t,e){},sfWC:function(t,e,n){"use strict";var o=n("aYsG"),s=n("/scB"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},sl5J:function(t,e,n){"use strict";var o=n("dcMW"),s=n.n(o);e.a={name:"CurveTool",computed:{icon:function(){return s.a}}}},syNJ:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("knr3");n.n(r);e.a={name:"PathSelect",props:{mouseX:Number,mouseY:Number,mousedownCount:Number},data:function(){return{points:[]}},computed:s()({pathD:function(){var t="";return this.points.forEach(function(e,n){0===n?t="M "+e.x+" "+e.y:n>0&&(t+=" L "+e.x+" "+e.y)}),t}},Object(i.c)(["isUsingCurveTool","selectedCharacters"])),methods:{restore:function(){this.points=[]}},watch:{mousedownCount:function(t){this.selectedCharacters.length>0&&this.points.push({x:this.mouseX,y:this.mouseY})},isUsingCurveTool:function(t){t?this.restore():this.points.length>0&&this.$store.dispatch("reshapeCharacters",this.points)}},mounted:function(){var t=this;(new r).bind("esc",function(){t.restore()})}}},t2k0:function(t,e,n){"use strict";var o=n("SQ8e"),s=n("Oky+"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},t3u6:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("rWw5"),a=n("vjNh");e.a={name:"PenTool",computed:s()({},Object(i.c)(["isUsingPenTool"])),watch:{isUsingPenTool:function(t){if(t){var e=new r.a("customshape");this.$store.commit(a.m,e)}}}}},"tS/o":function(t,e){},tbYJ:function(t,e){},u1Rf:function(t,e,n){"use strict";var o=n("H5jB"),s=n("gW7Q"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},u4D7:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"hexagon"},[n("path",{attrs:{d:t.pathD,fill:t.fillColor,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),t._l(t.nodes,function(e,o){return n("controlnode",{directives:[{name:"show",rawName:"v-show",value:t.reshape,expression:"reshape"}],key:o,attrs:{mouseX:t.mouseX,mouseY:t.mouseY,mouseupCount:t.mouseupCount,mousedownCount:t.mousedownCount,node:e}})})],2)},s=[],i={render:o,staticRenderFns:s};e.a=i},uBqI:function(t,e,n){"use strict";var o=n("QsEu"),s=n("rkOb"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},uWrl:function(t,e,n){"use strict";function o(t){n("rFRI")}var s=n("xGqh"),i=n("BAdX"),r=n("VU/8"),a=o,u=r(s.a,i.a,!1,a,null,null);e.a=u.exports},upPS:function(t,e,n){"use strict";var o=n("7TG9"),s=n("i0bz"),i=n("VU/8"),r=i(o.a,s.a,!1,null,null,null);e.a=r.exports},vDLA:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("vjNh"),a=n("cxcd"),u=n("1N/p"),c=n("rWw5"),l=n("knr3");n.n(l);e.a={name:"CustomShape",props:["mouseX","mouseY","mousedownCount","mouseupCount","fillColor","strokeColor","strokeWidth","opacity","object"],data:function(){return{draggedNodeId:-1,xReferedToNode:0,yReferedToNode:0}},computed:s()({nodes:function(){return this.object.nodes},visible:function(){return this.object.isShow},reshape:function(){return this.object.isReshape},created:function(){return this.object.isCreate},pathD:function(){var t=this,e="";return this.nodes.forEach(function(n,o){if(0===o)e+="M "+n.x+" "+n.y;else{var s=t.nodes[o-1];e+=" C "+s.x3+" "+s.y3+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y}}),e=this.nodes.length>2?e+="Z":e,e}},Object(i.c)(["isUsingPenTool","objects"])),methods:{deleteNode:function(t){this.object.deleteBezierNode(t)}},watch:{mousedownCount:function(t){this.created||(this.draggedNodeId=this.object.addBezierNode(this.mouseX,this.mouseY,this.mouseX,this.mouseY),this.nodes[this.draggedNodeId].activateBezierTool())},mouseupCount:function(t){!this.created&&this.draggedNodeId>-1&&this.nodes[this.draggedNodeId].closeBezierTool()},mouseX:function(t){if(!this.created){var e=this.draggedNodeId;if(e>-1){var n=this.nodes[e];n.isActiveBezierTool&&(n.x2=t,n.x3=2*n.x-t)}}},mouseY:function(t){if(!this.created){var e=this.draggedNodeId;if(e>-1){var n=this.nodes[e];n.isActiveBezierTool&&(n.y2=t,n.y3=2*n.y-t)}}},isUsingPenTool:function(t){this.object.isCreate||this.object.init()}},mounted:function(){var t=this;(new l).bind("esc",function(){t.object.init();var e=new c.a("customshape");t.$store.commit(r.m,e)})},components:{beziertool:a.a,controlnode:u.a}}},veAT:function(t,e){},vjNh:function(t,e,n){"use strict";n.d(e,"m",function(){return o}),n.d(e,"n",function(){return s}),n.d(e,"o",function(){return i}),n.d(e,"y",function(){return r}),n.d(e,"q",function(){return a}),n.d(e,"h",function(){return u}),n.d(e,"s",function(){return c}),n.d(e,"j",function(){return l}),n.d(e,"u",function(){return h}),n.d(e,"l",function(){return d}),n.d(e,"f",function(){return f}),n.d(e,"x",function(){return m}),n.d(e,"t",function(){return p}),n.d(e,"k",function(){return v}),n.d(e,"p",function(){return y}),n.d(e,"z",function(){return g}),n.d(e,"w",function(){return b}),n.d(e,"r",function(){return C}),n.d(e,"i",function(){return x}),n.d(e,"a",function(){return w}),n.d(e,"e",function(){return _}),n.d(e,"B",function(){return k}),n.d(e,"C",function(){return S}),n.d(e,"b",function(){return T}),n.d(e,"d",function(){return j}),n.d(e,"g",function(){return N}),n.d(e,"v",function(){return P}),n.d(e,"D",function(){return Y}),n.d(e,"A",function(){return O}),n.d(e,"c",function(){return X});var o="INSERT_VISUAL_OBJECT",s="LOCATE_FOCUSOBJECT",i="LOCATE_FOCUSOBJECT_STYLE",r="RESTORE_FOCUSOBJECT_STYLE",a="OPEN_FILL_COLOR",u="CLOSE_FILL_COLOR",c="OPEN_STROKE_COLOR",l="CLOSE_STROKE_COLOR",h="OPEN_TOOL",d="CLOSE_TOOL",f="CHANGE_TOOL",m="RESTORE_DEFAULT_TOOLS",p="OPEN_TEXT_TOOL",v="CLOSE_TEXT_TOOL",y="LOCATE_TEXT_OBJECT",g="RESTORE_TEXT_OBJECT",b="RESTORE_DEFAULT_OBJECTS",C="OPEN_PANEL",x="CLOSE_PANEL",w="ACTIVATE_PANEL",_="CHANGE_PANEL",k="UPDATE_REQUEST",S="UPDATE_STORYLINE",T="ADD_FOCUSING_CHARACTER",j="ADD_SELECTING_CHARACTER",N="CLEAR_SELECTING_CHARACTERS",P="RECORD_TARGET_PATH",Y="UPDATE_SVG_CARD",O="UNDO",X="ADD_HISTORY"},vqau:function(t,e,n){"use strict";var o=n("gsLH"),s=n("uWrl"),i=n("Yq7S"),r=n("BYOV");e.a={name:"ToolBox",data:function(){return{usingToolName:"",toolItems:["OrderTool","BendTool","ScaleTool","CurveTool"]}},methods:{enterTool:function(t){this.usingToolName=t},cancelTool:function(t){this.usingToolName=""}},components:{"upload-tool":s.a,"save-tool":i.a,"undo-tool":r.a,"tool-item":o.a}}},wEMg:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("NYxO"),r=n("vjNh"),a=n("dZkg");e.a={name:"MoveFrame",props:["mouseX","mouseY","mousedownCount","mouseupCount","object"],data:function(){return{moveDragged:!1,objectDragged:!1,recordedMouseX:0,recordedMouseY:0,displacementX:0,displacementY:0}},computed:s()({objectDraggedLocked:function(){return!this.object.isMove},moveDraggedLocked:function(){return!this.object.isSelected},xScaleFactor:function(){return this.storyConfig.xScaleFactor},yScaleFactor:function(){return this.storyConfig.yScaleFactor}},Object(i.c)(["storyConfig"])),methods:{handleMousedown:function(){0===event.button&&(this.recordedMouseX=this.mouseX,this.recordedMouseY=this.mouseY,this.object.initTransform(),this.objectDragged=!0)},handleMouseup:function(){0===event.button&&(this.lastDisplacementX=this.displacementX,this.lastDisplacementY=this.displacementY,this.objectDragged=!1),this.object.updateFrame(),this.object.updatePosition()},handleContextmenu:function(){return this.$store.commit(r.n,this.object),!1}},watch:{mouseX:function(t){this.displacementX=t-this.recordedMouseX,this.objectDragged&&!this.objectDraggedLocked&&("storyline"===this.object.type?this.object.updateX(this.displacementX/this.xScaleFactor):this.object.updateX(this.displacementX))},mouseY:function(t){this.displacementY=t-this.recordedMouseY,this.objectDragged&&!this.objectDraggedLocked&&("storyline"===this.object.type?this.object.updateY(this.displacementY/this.yScaleFactor):this.object.updateY(this.displacementY))}},components:{rotateframe:a.a}}},xGqh:function(t,e,n){"use strict";var o=n("vjNh");e.a={name:"UploadTool",methods:{handleUpload:function(t){var e=this,n=t.target.files[0],s=n.name.split(".")[1];if("xml"===s)this.$store.dispatch("uploadXMLFile",n);else if("json"===s){var i=new FileReader;i.onloadend=function(t){if(t.target.readyState===FileReader.DONE){var n=JSON.parse(t.target.result);e.$store.commit(o.x),e.$store.commit(o.B,n),e.$store.dispatch("updateStoryline")}},i.readAsText(n)}}}}},xJD8:function(t,e,n){"use strict";var o=n("YRYm"),s=n("qTQm"),i=n("NZGm"),r=n("/vB+");e.a={name:"App",mounted:function(){document.oncontextmenu=function(){return!1}},components:{"tool-box":o.a,workspace:s.a,"side-panelbar":i.a,"side-panel":r.a}}},y8Pj:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var o=n("ifoU"),s=n.n(o),i=n("Zrlr"),r=n.n(i),a=n("wxAW"),u=n.n(a),c=function(){function t(e){r()(this,t),this.sessionTable=e}return u()(t,[{key:"find",value:function(t,e){var n=new s.a,o=this.sessionTable[t][e];if(-1===o||9999===o)return n;for(var i=this.sessionTable[0].length,r=0;r<this.sessionTable.length;r++){for(var a=[],u=0;u<i;u++)this.sessionTable[r][u]===o&&a.push(u);a.length>0&&n.set(r,a)}return n}}]),t}()},"yO/d":function(t,e,n){"use strict";var o,s=n("bOdI"),i=n.n(s),r=n("vjNh"),a={isUsingOrderTool:!1,isUsingScaleTool:!1,isUsingBendTool:!1,isUsingCurveTool:!1,isUsingLinkTool:!1,isUsingUndoTool:!1,isUsingTextTool:!1,isUsingPenTool:!1},u={isUsingOrderTool:function(t){return t.isUsingOrderTool},isUsingBendTool:function(t){return t.isUsingBendTool},isUsingScaleTool:function(t){return t.isUsingScaleTool},isUsingCurveTool:function(t){return t.isUsingCurveTool},isUsingLinkTool:function(t){return t.isUsingLinkTool},isUsingUndoTool:function(t){return t.isUsingUndoTool},isUsingTextTool:function(t){return t.isUsingTextTool},isUsingPenTool:function(t){return t.isUsingPenTool}},c=(o={},i()(o,r.u,function(t,e){switch(e){case"OrderTool":t.isUsingOrderTool=!0;break;case"BendTool":t.isUsingBendTool=!0;break;case"ScaleTool":t.isUsingScaleTool=!0;break;case"CurveTool":t.isUsingCurveTool=!0;break;case"LinkTool":t.isUsingLinkTool=!0;break;case"PenTool":t.isUsingPenTool=!0;break;case"TextTool":t.isUsingTextTool=!0}}),i()(o,r.l,function(t,e){switch(e){case"OrderTool":t.isUsingOrderTool=!1;break;case"BendTool":t.isUsingBendTool=!1;break;case"ScaleTool":t.isUsingScaleTool=!1;break;case"CurveTool":t.isUsingCurveTool=!1;break;case"LinkTool":t.isUsingLinkTool=!1;break;case"PenTool":t.isUsingPenTool=!1;break;case"TextTool":t.isUsingTextTool=!1}}),i()(o,r.x,function(t){t.isUsingOrderTool=!1,t.isUsingBendTool=!1,t.isUsingScaleTool=!1,t.isUsingCurveTool=!1,t.isUsingLinkTool=!1,t.isUsingUndoTool=!1,t.isUsingTextTool=!1,t.isUsingPenTool=!1}),i()(o,r.t,function(t){t.isUsingTextTool=!0}),i()(o,r.k,function(t){t.isUsingTextTool=!1}),o);e.a={state:a,getters:u,mutations:c}},yezX:function(t,e,n){"use strict";var o=n("Dd8w"),s=n.n(o),i=n("M4fF"),r=n.n(i),a=n("NYxO"),u=n("u1Rf"),c=n("peX0");e.a={name:"ScaleFrame",props:["mouseX","mouseY","mousedownCount","mouseupCount","object"],data:function(){return{copyNodes:[]}},computed:s()({nodes:function(){return this.object.nodes},frameX:function(){return this.object.frameX},frameY:function(){return this.object.frameY},frameW:function(){return this.object.frameW},frameH:function(){return this.object.frameH},isScaleShow:function(){return"storyline"!==this.object.type&&("line"!==this.object.type&&(!(this.nodes.length<3)&&this.object.isScale))}},Object(a.c)(["isUsingPenTool"])),methods:{handleMousedown:function(){0===event.button&&(this.mousedownTime=Date.now(),this.copyNodes=r.a.cloneDeep(this.nodes))},handleMouseup:function(){if(0===event.button){var t=Date.now();t-this.mousedownTime<200?this.object.isReshape||(this.object.isScale?(this.object.closeScale(),"storyline"!==this.object.type&&this.object.activateMove()):(this.isUsingPenTool||this.object.activateScale(),this.object.closeMove())):this.mousedownTime=t}},scaleByX:function(t){var e=t/this.frameW,n=this.frameX+this.frameW;this.updateNodeX(e,n)},scaleByY:function(t){var e=t/this.frameH,n=this.frameY+this.frameH;this.updateNodeY(e,n)},scaleByW:function(t){var e=t/this.frameW,n=this.frameX;this.updateNodeX(e,n)},scaleByH:function(t){var e=t/this.frameH,n=this.frameY;this.updateNodeY(e,n)},updateNodeX:function(t,e){var n=this;this.nodes.forEach(function(o,s){var i=n.copyNodes[s];o._x=(i._x-e)*t+e,o._x2=(i._x2-e)*t+e,o._x3=(i._x3-e)*t+e})},updateNodeY:function(t,e){var n=this;this.nodes.forEach(function(o,s){var i=n.copyNodes[s];o._y=(i._y-e)*t+e,o._y2=(i._y2-e)*t+e,o._y3=(i._y3-e)*t+e})},updateFrame:function(t){this.object.frameX=t.x,this.object.frameY=t.y,this.object.frameW=t.w,this.object.frameH=t.h,this.object.updatePosition()},rotate:function(t){var e=t.sin,n=t.cos;this.$emit("rotate",{sin:e,cos:n})}},components:{styleframe:c.a,rectframe:u.a}}},yq3R:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"storyline",on:{mousedown:t.handleMousedown,mouseup:t.handleMouseup}},[n("path",{attrs:{fill:"none",d:t.pathD,stroke:"white","stroke-width":"10",opacity:"1"}}),t._v(" "),n("path",{attrs:{fill:"none",d:t.pathD,stroke:t.strokeColor,"stroke-width":t.strokeWidth,opacity:t.opacity}}),t._v(" "),n("text",{staticClass:"label",attrs:{"text-anchor":"end","font-size":"16",x:t.labelX,y:t.labelY},on:{click:function(e){return e.stopPropagation(),t.handleSelecting(e)},mousedown:function(e){return e.stopPropagation(),t.beginDragMoving(e)},mouseup:t.endDragMoving}},[t._v("\n    "+t._s(t.character)+"\n  ")])])},s=[],i={render:o,staticRenderFns:s};e.a=i},z4iF:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return u}),n.d(e,"c",function(){return c});var o=n("Zrlr"),s=n.n(o),i=n("wxAW"),r=n.n(i),a=function(){function t(e,n,o,i){s()(this,t),this._activate=!1,this._last=null,this._x=e,this._y=n,this._xBak=e,this._yBak=n,this._x2=o,this._y2=i,this._xBak2=o,this._yBak2=i,this._x3=2*o-e,this._y3=2*i-n,this._xBak3=this._x3,this._yBak3=this._y3}return r()(t,[{key:"backup",value:function(){this._xBak=this._x,this._yBak=this._y,this._xBak2=this._x2,this._yBak2=this._y2,this._xBak3=this._x3,this._yBak3=this._y3}},{key:"activateBezierTool",value:function(){this._activate=!0}},{key:"closeBezierTool",value:function(){this._activate=!1}},{key:"move",value:function(t,e){this._x+=t,this._y+=e,this._x2+=t,this._y2+=e,this._x3+=t,this._y3+=e}},{key:"update",value:function(t,e){this._x=this._xBak+t,this._y=this._yBak+e,this._x2=this._xBak2+t,this._y2=this._yBak2+e,this._x3=this._xBak3+t,this._y3=this._yBak3+e}},{key:"updateX",value:function(t){this._x=this._xBak+t,this._x2=this._xBak2+t,this._x3=this._xBak3+t}},{key:"updateY",value:function(t){this._y=this._yBak+t,this._y2=this._yBak2+t,this._y3=this._yBak3+t}},{key:"rotate",value:function(t,e,n,o){this._x=(this._xBak-n)*e-(this._yBak-o)*t+n,this._y=(this._xBak-n)*t+(this._yBak-o)*e+o,this._x2=(this._xBak2-n)*e-(this._yBak2-o)*t+n,this._y2=(this._xBak2-n)*t+(this._yBak2-o)*e+o,this._x3=(this._xBak3-n)*e-(this._yBak3-o)*t+n,this._y3=(this._xBak3-n)*t+(this._yBak3-o)*e+o}},{key:"isActiveBezierTool",get:function(){return this._activate}},{key:"lastNode",set:function(t){this._last=t},get:function(){return this._last}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"x2",get:function(){return this._x2},set:function(t){this._x2=t}},{key:"y2",get:function(){return this._y2},set:function(t){this._y2=t}},{key:"x3",set:function(t){this._x3=t},get:function(){return this._x3}},{key:"y3",get:function(){return this._y3},set:function(t){this._y3=t}}]),t}(),u=function(){function t(e,n){s()(this,t),this.x=e,this._xBak=e,this.y=n,this._yBak=n,this.isOptimized=!1,this.isOptimizedTmp=!1}return r()(t,[{key:"backup",value:function(){this._xBak=this.x,this._yBak=this.y}},{key:"move",value:function(t,e){this.x+=t,this.y+=e}},{key:"updateX",value:function(t){this.x=this._xBak+t}},{key:"updateY",value:function(t){this.y=this.y>-1e4?this._yBak+t:-1e4}},{key:"rotate",value:function(t,e,n,o){this.x=(this._xBak-n)*e-(this._yBak-o)*t+n,this.y=(this._xBak-n)*t+(this._yBak-o)*e+o}}]),t}(),c=function t(e,n){s()(this,t),this.x=e,this.y=n}},"zr+e":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{directives:[{name:"show",rawName:"v-show",value:t.isUsingCurveTool,expression:"isUsingCurveTool"}],staticClass:"path-select"},[n("path",{attrs:{d:t.pathD,fill:"none",stroke:"blue","stroke-width":"5"}})])},s=[],i={render:o,staticRenderFns:s};e.a=i}},["NHnr"]);
//# sourceMappingURL=app.64383804c8a90248b6d8.js.map